<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="733px" preserveAspectRatio="none" style="width:485px;height:733px;" version="1.1" viewBox="0 0 485 733" width="485px" zoomAndPan="magnify"><defs><filter height="300%" id="ftxz0h4rhuz8l" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="233" x="124.25" y="29.4023">Automatic Route Discovery</text><rect fill="#FFFFFF" filter="url(#ftxz0h4rhuz8l)" height="177.5313" style="stroke:#000000;stroke-width:2.0;" width="302" x="169.5" y="201.6875"/><rect fill="#FFFFFF" filter="url(#ftxz0h4rhuz8l)" height="146.2207" style="stroke:#000000;stroke-width:2.0;" width="256.5" x="179.5" y="225.998"/><rect fill="#FFFFFF" height="39.9551" style="stroke:none;stroke-width:1.0;" width="256.5" x="179.5" y="281.3086"/><rect fill="#FFFFFF" height="50.9551" style="stroke:none;stroke-width:1.0;" width="256.5" x="179.5" y="321.2637"/><rect fill="#FFFFFF" filter="url(#ftxz0h4rhuz8l)" height="158.2656" style="stroke:#000000;stroke-width:2.0;" width="256.5" x="179.5" y="428.2188"/><rect fill="#FFFFFF" height="77.9551" style="stroke:none;stroke-width:1.0;" width="256.5" x="179.5" y="508.5293"/><line style="stroke:#44AAFF;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="41" x2="41" y1="102.6875" y2="649.4844"/><line style="stroke:#44AAFF;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="220.5" x2="220.5" y1="102.6875" y2="649.4844"/><line style="stroke:#44AAFF;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="379" x2="379" y1="102.6875" y2="649.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="5" y="99.7344">Lift Agent</text><ellipse cx="41" cy="70.1992" fill="#FEFECE" filter="url(#ftxz0h4rhuz8l)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="37,58.1992,43,53.1992,41,58.1992,43,63.1992,37,58.1992" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="5" y="662.0195">Lift Agent</text><ellipse cx="41" cy="680.9727" fill="#FEFECE" filter="url(#ftxz0h4rhuz8l)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="37,668.9727,43,663.9727,41,668.9727,43,673.9727,37,668.9727" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="189.5" y="99.7344">Local DB</text><path d="M203,50.1992 C203,40.1992 221,40.1992 221,40.1992 C221,40.1992 239,40.1992 239,50.1992 L239,76.1992 C239,86.1992 221,86.1992 221,86.1992 C221,86.1992 203,86.1992 203,76.1992 L203,50.1992 " fill="#FEFECE" filter="url(#ftxz0h4rhuz8l)" style="stroke:#000000;stroke-width:1.5;"/><path d="M203,50.1992 C203,60.1992 221,60.1992 221,60.1992 C221,60.1992 239,60.1992 239,50.1992 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="189.5" y="662.0195">Local DB</text><path d="M203,674.9727 C203,664.9727 221,664.9727 221,664.9727 C221,664.9727 239,664.9727 239,674.9727 L239,700.9727 C239,710.9727 221,710.9727 221,710.9727 C221,710.9727 203,710.9727 203,700.9727 L203,674.9727 " fill="#FEFECE" filter="url(#ftxz0h4rhuz8l)" style="stroke:#000000;stroke-width:1.5;"/><path d="M203,674.9727 C203,684.9727 221,684.9727 221,684.9727 C221,684.9727 239,684.9727 239,674.9727 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="332" y="99.7344">Upstream DB</text><path d="M361,50.1992 C361,40.1992 379,40.1992 379,40.1992 C379,40.1992 397,40.1992 397,50.1992 L397,76.1992 C397,86.1992 379,86.1992 379,86.1992 C379,86.1992 361,86.1992 361,76.1992 L361,50.1992 " fill="#FEFECE" filter="url(#ftxz0h4rhuz8l)" style="stroke:#000000;stroke-width:1.5;"/><path d="M361,50.1992 C361,60.1992 379,60.1992 379,60.1992 C379,60.1992 397,60.1992 397,50.1992 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="332" y="662.0195">Upstream DB</text><path d="M361,674.9727 C361,664.9727 379,664.9727 379,664.9727 C379,664.9727 397,664.9727 397,674.9727 L397,700.9727 C397,710.9727 379,710.9727 379,710.9727 C379,710.9727 361,710.9727 361,700.9727 L361,674.9727 " fill="#FEFECE" filter="url(#ftxz0h4rhuz8l)" style="stroke:#000000;stroke-width:1.5;"/><path d="M361,674.9727 C361,684.9727 379,684.9727 379,684.9727 C379,684.9727 397,684.9727 397,674.9727 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#000000" points="209,125.6875,219,129.6875,209,133.6875,213,129.6875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="41" x2="215" y1="129.6875" y2="129.6875"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="156" x="48" y="125.1577">Request scan of local segments</text><path d="M136,142.6875 L136,185.6875 L301,185.6875 L301,152.6875 L291,142.6875 L136,142.6875 " fill="#E8E8EA" filter="url(#ftxz0h4rhuz8l)" style="stroke:#202024;stroke-width:1.0;"/><path d="M291,142.6875 L291,152.6875 L301,152.6875 L291,142.6875 " fill="#E8E8EA" style="stroke:#202024;stroke-width:1.0;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="144" x="142" y="156.1577">Query for local segments that</text><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="112" x="142" y="167.1577">- have lift capacity; and</text><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="103" x="142" y="178.1577">- need route attention</text><path d="M169.5,201.6875 L243.5,201.6875 L243.5,208.6875 L233.5,218.6875 L169.5,218.6875 L169.5,201.6875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="177.5313" style="stroke:#000000;stroke-width:2.0;" width="302" x="169.5" y="201.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="184.5" y="215.2559">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="208" x="258.5" y="214.3223">[Over all segments with lift capacity]</text><path d="M179.5,225.998 L241.5,225.998 L241.5,232.998 L231.5,242.998 L179.5,242.998 L179.5,225.998 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="146.2207" style="stroke:#000000;stroke-width:2.0;" width="256.5" x="179.5" y="225.998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="194.5" y="239.5664">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="143" x="256.5" y="238.6328">[Current routes available]</text><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="263" y1="260.3086" y2="260.3086"/><line style="stroke:#000000;stroke-width:1.0;" x1="263" x2="263" y1="260.3086" y2="273.3086"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="263" y1="273.3086" y2="273.3086"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="232" y1="273.3086" y2="269.3086"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="232" y1="273.3086" y2="277.3086"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="144" x="228" y="255.7788">Initiate lift request on segment</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="179.5" x2="436" y1="282.3086" y2="282.3086"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="184.5" y="292.9434">[Stale route found (good or failed)]</text><line style="stroke:#000000;stroke-width:1.0;" x1="377" x2="367" y1="313.2637" y2="309.2637"/><line style="stroke:#000000;stroke-width:1.0;" x1="377" x2="367" y1="313.2637" y2="317.2637"/><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="378" y1="313.2637" y2="313.2637"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="107" x="228" y="308.7339">Request route refresh</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="179.5" x2="436" y1="322.2637" y2="322.2637"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="184.5" y="332.8984">[No route found]</text><line style="stroke:#000000;stroke-width:1.0;" x1="377" x2="367" y1="364.2188" y2="360.2188"/><line style="stroke:#000000;stroke-width:1.0;" x1="377" x2="367" y1="364.2188" y2="368.2188"/><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="378" y1="364.2188" y2="364.2188"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="86" x="228" y="348.689">Create draft route</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="80" x="228" y="359.689">Query upstream</text><path d="M109,391.2188 L109,412.2188 L328,412.2188 L328,401.2188 L318,391.2188 L109,391.2188 " fill="#E8E8EA" filter="url(#ftxz0h4rhuz8l)" style="stroke:#202024;stroke-width:1.0;"/><path d="M318,391.2188 L318,401.2188 L328,401.2188 L318,391.2188 " fill="#E8E8EA" style="stroke:#202024;stroke-width:1.0;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="198" x="115" y="404.689">new route status indeterminate (pending)</text><path d="M179.5,428.2188 L241.5,428.2188 L241.5,435.2188 L231.5,445.2188 L179.5,445.2188 L179.5,428.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="158.2656" style="stroke:#000000;stroke-width:2.0;" width="256.5" x="179.5" y="428.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="194.5" y="441.7871">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="256.5" y="440.8535">[Negative response]</text><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="231" y1="462.5293" y2="458.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="231" y1="462.5293" y2="466.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="378" y1="462.5293" y2="462.5293"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="83" x="238" y="457.9995">Route impossible</text><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="263" y1="487.5293" y2="487.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="263" x2="263" y1="487.5293" y2="500.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="263" y1="500.5293" y2="500.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="232" y1="500.5293" y2="496.5293"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="232" y1="500.5293" y2="504.5293"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="107" x="228" y="482.9995">Set route status = bad</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="179.5" x2="436" y1="509.5293" y2="509.5293"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="107" x="184.5" y="520.1641">[Positive response]</text><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="231" y1="540.4844" y2="536.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="231" y1="540.4844" y2="544.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="378" y1="540.4844" y2="540.4844"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="238" y="535.9546">Route good</text><line style="stroke:#000000;stroke-width:1.0;" x1="221" x2="263" y1="565.4844" y2="565.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="263" x2="263" y1="565.4844" y2="578.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="263" y1="578.4844" y2="578.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="232" y1="578.4844" y2="574.4844"/><line style="stroke:#000000;stroke-width:1.0;" x1="222" x2="232" y1="578.4844" y2="582.4844"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="113" x="228" y="560.9546">Set route status = good</text><path d="M147,598.4844 L147,630.4844 L291,630.4844 L291,608.4844 L281,598.4844 L147,598.4844 " fill="#E8E8EA" filter="url(#ftxz0h4rhuz8l)" style="stroke:#202024;stroke-width:1.0;"/><path d="M281,598.4844 L281,608.4844 L291,608.4844 L281,598.4844 " fill="#E8E8EA" style="stroke:#202024;stroke-width:1.0;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="123" x="153" y="611.9546">routes will eventually time</text><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="104" x="153" y="622.9546">out and become stale</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="150" x="165.75" y="724.6406">Thu Mar 11 19:21:55 MST 2021</text><!--MD5=[eecda2400c37b410abcc4c8e0655d9b9]
@startuml
!include common.puml
$title(Automatic Route Discovery)
control "Lift Agent" as agent
database "Local DB" as localDB
database "Upstream DB" as upDB
'database "Downstream DB" as downDB

agent	->	localDB:		Request scan of local segments

note over localDB
  Query for local segments that
  - have lift capacity; and
  - need route attention
end note

loop Over all segments with lift capacity
  alt Current routes available
    localDB	->>	localDB:	Initiate lift request on segment
  
  else Stale route found (good or failed)
    localDB	->>	upDB:		Request route refresh
    
  else No route found
    localDB	->>	upDB:		Create draft route\nQuery upstream
    
  end
end

  note over localDB: new route status indeterminate (pending)

alt Negative response
  upDB	->>	localDB:		Route impossible
  localDB	->>	localDB:	Set route status = bad
  
else Positive response
  upDB	->>	localDB:		Route good
  localDB	->>	localDB:	Set route status = good

end
  note over localDB: routes will eventually time\nout and become stale
  
@enduml

@startuml



skinparam backgroundColor fff
skinparam stereotypeCBackgroundColor 27d






skinparam circledCharacter {
  radius 8
  fontSize 11
  fontName Helvetica
}

skinparam class {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  attributeFontColor 333
  attributeFontSize 11
  attributeIconSize 11
}

skinparam actor {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam participant {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam collections {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam SequenceBox{
    backgroundColor e0e0e0
  borderColor cccccc
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam interface {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam component {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}



skinparam queue {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam usecase {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam activity {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam sequence {
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  lifeLineBorderColor 4af
  lifeLineBackgroundColor e0e0e0
}




skinparam state {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
  startColor 4af
  endColor 27d
}

skinparam note {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}







  title Automatic Route Discovery
  footer Thu Mar 11 19:21:55 MST 2021
control "Lift Agent" as agent
database "Local DB" as localDB
database "Upstream DB" as upDB

agent	->	localDB:		Request scan of local segments

note over localDB
  Query for local segments that
  - have lift capacity; and
  - need route attention
end note

loop Over all segments with lift capacity
  alt Current routes available
    localDB	->>	localDB:	Initiate lift request on segment
  
  else Stale route found (good or failed)
    localDB	->>	upDB:		Request route refresh
    
  else No route found
    localDB	->>	upDB:		Create draft route\nQuery upstream
    
  end
end

  note over localDB: new route status indeterminate (pending)

alt Negative response
  upDB	->>	localDB:		Route impossible
  localDB	->>	localDB:	Set route status = bad
  
else Positive response
  upDB	->>	localDB:		Route good
  localDB	->>	localDB:	Set route status = good

end
  note over localDB: routes will eventually time\nout and become stale
  
@enduml

PlantUML version 1.2021.00(Sun Jan 10 03:25:05 MST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>