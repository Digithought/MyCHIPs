<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="912px" preserveAspectRatio="none" style="width:609px;height:912px;" version="1.1" viewBox="0 0 609 912" width="609px" zoomAndPan="magnify"><defs><filter height="300%" id="fs47r31xswiq2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="166" x="219.5" y="29.4023">Establishing a Tally</text><rect fill="#FFFFFF" filter="url(#fs47r31xswiq2)" height="42.3105" style="stroke:#000000;stroke-width:2.0;" width="234" x="361" y="358.1992"/><rect fill="#FFFFFF" filter="url(#fs47r31xswiq2)" height="347.2207" style="stroke:#000000;stroke-width:2.0;" width="585" x="10" y="414.5098"/><rect fill="#FFFFFF" height="164.9551" style="stroke:none;stroke-width:1.0;" width="585" x="10" y="506.8203"/><rect fill="#FFFFFF" height="89.9551" style="stroke:none;stroke-width:1.0;" width="585" x="10" y="671.7754"/><line style="stroke:#44AAFF;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="118.1992" y2="813.7305"/><line style="stroke:#44AAFF;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="217.5" x2="217.5" y1="118.1992" y2="813.7305"/><line style="stroke:#44AAFF;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="410" x2="410" y1="118.1992" y2="813.7305"/><line style="stroke:#44AAFF;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="564" x2="564" y1="118.1992" y2="813.7305"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="48" x="20" y="115.6694">Originator</text><ellipse cx="47" cy="50.1992" fill="#44AAFF" filter="url(#fs47r31xswiq2)" rx="8" ry="8" style="stroke:#2277DD;stroke-width:2.0;"/><path d="M47,58.1992 L47,85.1992 M34,66.1992 L60,66.1992 M47,85.1992 L34,100.1992 M47,85.1992 L60,100.1992 " fill="none" filter="url(#fs47r31xswiq2)" style="stroke:#2277DD;stroke-width:2.0;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="48" x="20" y="821.2007">Originator</text><ellipse cx="47" cy="833.7305" fill="#44AAFF" filter="url(#fs47r31xswiq2)" rx="8" ry="8" style="stroke:#2277DD;stroke-width:2.0;"/><path d="M47,841.7305 L47,868.7305 M34,849.7305 L60,849.7305 M47,868.7305 L34,883.7305 M47,868.7305 L60,883.7305 " fill="none" filter="url(#fs47r31xswiq2)" style="stroke:#2277DD;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="168.5" y="115.2461">Originator DB</text><path d="M200,65.7109 C200,55.7109 218,55.7109 218,55.7109 C218,55.7109 236,55.7109 236,65.7109 L236,91.7109 C236,101.7109 218,101.7109 218,101.7109 C218,101.7109 200,101.7109 200,91.7109 L200,65.7109 " fill="#FEFECE" filter="url(#fs47r31xswiq2)" style="stroke:#000000;stroke-width:1.5;"/><path d="M200,65.7109 C200,75.7109 218,75.7109 218,75.7109 C218,75.7109 236,75.7109 236,65.7109 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="168.5" y="826.2656">Originator DB</text><path d="M200,839.2188 C200,829.2188 218,829.2188 218,829.2188 C218,829.2188 236,829.2188 236,839.2188 L236,865.2188 C236,875.2188 218,875.2188 218,875.2188 C218,875.2188 200,875.2188 200,865.2188 L200,839.2188 " fill="#FEFECE" filter="url(#fs47r31xswiq2)" style="stroke:#000000;stroke-width:1.5;"/><path d="M200,839.2188 C200,849.2188 218,849.2188 218,849.2188 C218,849.2188 236,849.2188 236,839.2188 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="371" y="115.2461">Subject DB</text><path d="M392,65.7109 C392,55.7109 410,55.7109 410,55.7109 C410,55.7109 428,55.7109 428,65.7109 L428,91.7109 C428,101.7109 410,101.7109 410,101.7109 C410,101.7109 392,101.7109 392,91.7109 L392,65.7109 " fill="#FEFECE" filter="url(#fs47r31xswiq2)" style="stroke:#000000;stroke-width:1.5;"/><path d="M392,65.7109 C392,75.7109 410,75.7109 410,75.7109 C410,75.7109 428,75.7109 428,65.7109 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="371" y="826.2656">Subject DB</text><path d="M392,839.2188 C392,829.2188 410,829.2188 410,829.2188 C410,829.2188 428,829.2188 428,839.2188 L428,865.2188 C428,875.2188 410,875.2188 410,875.2188 C410,875.2188 392,875.2188 392,865.2188 L392,839.2188 " fill="#FEFECE" filter="url(#fs47r31xswiq2)" style="stroke:#000000;stroke-width:1.5;"/><path d="M392,839.2188 C392,849.2188 410,849.2188 410,849.2188 C410,849.2188 428,849.2188 428,839.2188 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="36" x="543" y="115.6694">Subject</text><ellipse cx="564" cy="50.1992" fill="#44AAFF" filter="url(#fs47r31xswiq2)" rx="8" ry="8" style="stroke:#2277DD;stroke-width:2.0;"/><path d="M564,58.1992 L564,85.1992 M551,66.1992 L577,66.1992 M564,85.1992 L551,100.1992 M564,85.1992 L577,100.1992 " fill="none" filter="url(#fs47r31xswiq2)" style="stroke:#2277DD;stroke-width:2.0;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="36" x="543" y="821.2007">Subject</text><ellipse cx="564" cy="833.7305" fill="#44AAFF" filter="url(#fs47r31xswiq2)" rx="8" ry="8" style="stroke:#2277DD;stroke-width:2.0;"/><path d="M564,841.7305 L564,868.7305 M551,849.7305 L577,849.7305 M564,868.7305 L551,883.7305 M564,868.7305 L577,883.7305 " fill="none" filter="url(#fs47r31xswiq2)" style="stroke:#2277DD;stroke-width:2.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="216" x2="206" y1="145.1992" y2="141.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="216" x2="206" y1="145.1992" y2="149.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="217" y1="145.1992" y2="145.1992"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="147" x="54" y="140.6694">Create draft, signed tally/ticket</text><path d="M46,158.1992 L46,179.1992 L386,179.1992 L386,168.1992 L376,158.1992 L46,158.1992 " fill="#E8E8EA" filter="url(#fs47r31xswiq2)" style="stroke:#202024;stroke-width:1.0;"/><path d="M376,158.1992 L376,168.1992 L386,168.1992 L376,158.1992 " fill="#E8E8EA" style="stroke:#202024;stroke-width:1.0;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="319" x="52" y="171.6694">Ticket may be permanent or expiring and for one or multiple peers</text><line style="stroke:#FF0000;stroke-width:1.0;" x1="562" x2="552" y1="205.1992" y2="201.1992"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="562" x2="552" y1="205.1992" y2="209.1992"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="47" x2="563" y1="205.1992" y2="205.1992"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="264" x="54" y="200.6694">Communicate ticket to peer via QR code (out-of-band)</text><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="230.1992" y2="226.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="230.1992" y2="234.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="563" y1="230.1992" y2="230.1992"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="130" x="427" y="225.6694">Add peer specified in ticket</text><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="255.1992" y2="251.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="255.1992" y2="259.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="409" y1="255.1992" y2="255.1992"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="168" x="235" y="250.6694">Connect via ticket, exchange keys</text><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="260" y1="280.1992" y2="280.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="260" x2="260" y1="280.1992" y2="293.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="219" x2="260" y1="293.1992" y2="293.1992"/><polygon fill="#000000" points="229,289.1992,219,293.1992,229,297.1992,225,293.1992" style="stroke:#000000;stroke-width:1.0;"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="144" x="225" y="275.6694">Detect pending proposed tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="408" x2="398" y1="318.1992" y2="314.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="408" x2="398" y1="318.1992" y2="322.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="409" y1="318.1992" y2="318.1992"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="96" x="225" y="313.6694">Send proposed tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="562" x2="552" y1="343.1992" y2="339.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="562" x2="552" y1="343.1992" y2="347.1992"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="563" y1="343.1992" y2="343.1992"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="89" x="417" y="338.6694">Present for review</text><path d="M361,358.1992 L435,358.1992 L435,365.1992 L425,375.1992 L361,375.1992 L361,358.1992 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="42.3105" style="stroke:#000000;stroke-width:2.0;" width="234" x="361" y="358.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="376" y="371.7676">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="86" x="450" y="370.834">[until satisfied]</text><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="392.5098" y2="388.5098"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="392.5098" y2="396.5098"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="563" y1="392.5098" y2="392.5098"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="85" x="427" y="387.98">Modify tally terms</text><path d="M10,414.5098 L72,414.5098 L72,421.5098 L62,431.5098 L10,431.5098 L10,414.5098 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="347.2207" style="stroke:#000000;stroke-width:2.0;" width="585" x="10" y="414.5098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="428.0781">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="101" x="87" y="427.1445">[Terms agreeable]</text><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="448.8203" y2="444.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="448.8203" y2="452.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="563" y1="448.8203" y2="448.8203"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="427" y="444.2905">Accept/sign tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="473.8203" y2="469.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="473.8203" y2="477.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="409" y1="473.8203" y2="473.8203"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="95" x="235" y="469.2905">Send accepted tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="57" y1="498.8203" y2="494.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="57" y1="498.8203" y2="502.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="217" y1="498.8203" y2="498.8203"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="101" x="64" y="494.2905">Store and notify user</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="595" y1="507.8203" y2="507.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="96" x="15" y="518.4551">[Want to counter]</text><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="538.7754" y2="534.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="538.7754" y2="542.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="563" y1="538.7754" y2="538.7754"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="427" y="534.2456">Counter offer</text><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="563.7754" y2="559.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="563.7754" y2="567.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="409" y1="563.7754" y2="563.7754"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="96" x="235" y="559.2456">Send proposed tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="57" y1="588.7754" y2="584.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="57" y1="588.7754" y2="592.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="217" y1="588.7754" y2="588.7754"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="89" x="64" y="584.2456">Present for review</text><line style="stroke:#000000;stroke-width:1.0;" x1="216" x2="206" y1="613.7754" y2="609.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="216" x2="206" y1="613.7754" y2="617.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="217" y1="613.7754" y2="613.7754"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="54" y="609.2456">Accept/sign tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="408" x2="398" y1="638.7754" y2="634.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="408" x2="398" y1="638.7754" y2="642.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="409" y1="638.7754" y2="638.7754"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="95" x="225" y="634.2456">Send accepted tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="562" x2="552" y1="663.7754" y2="659.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="562" x2="552" y1="663.7754" y2="667.7754"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="563" y1="663.7754" y2="663.7754"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="101" x="417" y="659.2456">Store and notify user</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="595" y1="672.7754" y2="672.7754"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="15" y="683.4102">[Refuse terms]</text><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="703.7305" y2="699.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="420" y1="703.7305" y2="707.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="410" x2="563" y1="703.7305" y2="703.7305"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="102" x="427" y="699.2007">Mark tally as refused</text><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="728.7305" y2="724.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="228" y1="728.7305" y2="732.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="218" x2="409" y1="728.7305" y2="728.7305"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="95" x="235" y="724.2007">Send accepted tally</text><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="57" y1="753.7305" y2="749.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="57" y1="753.7305" y2="757.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="47" x2="217" y1="753.7305" y2="753.7305"/><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="101" x="64" y="749.2007">Store and notify user</text><path d="M176,773.7305 L176,794.7305 L451,794.7305 L451,783.7305 L441,773.7305 L176,773.7305 " fill="#E8E8EA" filter="url(#fs47r31xswiq2)" style="stroke:#202024;stroke-width:1.0;"/><path d="M441,773.7305 L441,783.7305 L451,783.7305 L441,773.7305 " fill="#E8E8EA" style="stroke:#202024;stroke-width:1.0;"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="220" x="197.25" y="787.2007">Signed tally can now be used for transactions</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="145" x="230" y="904.3984">Thu Jul 01 17:14:15 MDT 2021</text><!--MD5=[e476be02d15e9fd7a51177bd7325fb1f]
@startuml
!include common.puml
$title(Establishing a Tally)
actor "Originator" as prop
database "Originator DB" as propDB
database "Subject DB" as subjDB
actor "Subject" as subj

prop	->>	propDB:		Create draft, signed tally/ticket
note over propDB
  Ticket may be permanent or expiring and for one or multiple peers
end note
prop	-[#red]>> subj:		Communicate ticket to peer via QR code (out-of-band)
subj	->>	subjDB:		Add peer specified in ticket
subjDB	->>	propDB:		Connect via ticket, exchange keys
propDB	->	propDB:		Detect pending proposed tally
propDB	->>	subjDB:		Send proposed tally
subjDB	->>	subj:		Present for review
loop until satisfied
 subj	->>	subjDB:		Modify tally terms
end loop

alt Terms agreeable
 subj	->>	subjDB:		Accept/sign tally
 subjDB ->>	propDB:		Send accepted tally
 propDB	->>	prop:		Store and notify user

else Want to counter
 subj	->>	subjDB:		Counter offer
 subjDB	->>	propDB:		Send proposed tally
 propDB	->>	prop:		Present for review
 prop	->>	propDB:		Accept/sign tally
 propDB	->>	subjDB:		Send accepted tally
 subjDB	->>	subj:		Store and notify user

else Refuse terms
 subj	->>	subjDB:		Mark tally as refused
 subjDB ->>	propDB:		Send accepted tally
 propDB	->>	prop:		Store and notify user
end

note over propDB, subjDB
  Signed tally can now be used for transactions
end note

@enduml

@startuml



skinparam backgroundColor fff
skinparam stereotypeCBackgroundColor 27d






skinparam circledCharacter {
  radius 8
  fontSize 11
  fontName Helvetica
}

skinparam class {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  attributeFontColor 333
  attributeFontSize 11
  attributeIconSize 11
}

skinparam actor {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam participant {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam collections {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam SequenceBox{
    backgroundColor e0e0e0
  borderColor cccccc
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam interface {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam component {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}



skinparam queue {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam usecase {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam activity {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam sequence {
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  lifeLineBorderColor 4af
  lifeLineBackgroundColor e0e0e0
}




skinparam state {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
  startColor 4af
  endColor 27d
}

skinparam note {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}







  title Establishing a Tally
  footer Thu Jul 01 17:14:15 MDT 2021
actor "Originator" as prop
database "Originator DB" as propDB
database "Subject DB" as subjDB
actor "Subject" as subj

prop	->>	propDB:		Create draft, signed tally/ticket
note over propDB
  Ticket may be permanent or expiring and for one or multiple peers
end note
prop	-[#red]>> subj:		Communicate ticket to peer via QR code (out-of-band)
subj	->>	subjDB:		Add peer specified in ticket
subjDB	->>	propDB:		Connect via ticket, exchange keys
propDB	->	propDB:		Detect pending proposed tally
propDB	->>	subjDB:		Send proposed tally
subjDB	->>	subj:		Present for review
loop until satisfied
 subj	->>	subjDB:		Modify tally terms
end loop

alt Terms agreeable
 subj	->>	subjDB:		Accept/sign tally
 subjDB ->>	propDB:		Send accepted tally
 propDB	->>	prop:		Store and notify user

else Want to counter
 subj	->>	subjDB:		Counter offer
 subjDB	->>	propDB:		Send proposed tally
 propDB	->>	prop:		Present for review
 prop	->>	propDB:		Accept/sign tally
 propDB	->>	subjDB:		Send accepted tally
 subjDB	->>	subj:		Store and notify user

else Refuse terms
 subj	->>	subjDB:		Mark tally as refused
 subjDB ->>	propDB:		Send accepted tally
 propDB	->>	prop:		Store and notify user
end

note over propDB, subjDB
  Signed tally can now be used for transactions
end note

@enduml

PlantUML version 1.2021.00(Sun Jan 10 03:25:05 MST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>