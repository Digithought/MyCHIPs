<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="502px" preserveAspectRatio="none" style="width:778px;height:502px;" version="1.1" viewBox="0 0 778 502" width="778px" zoomAndPan="magnify"><defs><filter height="300%" id="f1i48knb0e5spg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="164" x="300.5" y="17.4023">Chit State Diagram</text><ellipse cx="320" cy="37.1992" fill="#44AAFF" filter="url(#f1i48knb0e5spg)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><g id="void"><rect fill="#E8E8EA" filter="url(#f1i48knb0e5spg)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="100" x="270" y="119.6992"/><line style="stroke:#202024;stroke-width:1.5;" x1="270" x2="370" y1="140.6992" y2="140.6992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="80" x="280" y="133.1694">void (or No Chit)</text></g><g id="userRequest"><rect fill="#E8E8EA" filter="url(#f1i48knb0e5spg)" height="59.2656" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="196" x="505" y="115.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="505" x2="701" y1="136.1992" y2="136.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="63" x="571.5" y="128.6694">userRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="176" x="510" y="152.8008">Stat: void, Req=&gt;userRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="68" x="510" y="166.9336">E: Store chit</text></g><g id="peerInvoice"><rect fill="#E8E8EA" filter="url(#f1i48knb0e5spg)" height="73.3984" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="134" x="7" y="108.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="7" x2="141" y1="129.1992" y2="129.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="57" x="45.5" y="121.6694">peerInvoice</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="114" x="12" y="145.8008">Stat: void, Req=null</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="68" x="12" y="159.9336">E: Store chit</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="81" x="12" y="174.0664">E: Update chit</text></g><g id="userInvoice"><rect fill="#E8E8EA" filter="url(#f1i48knb0e5spg)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="149" x="482.5" y="276.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="482.5" x2="631.5" y1="297.1992" y2="297.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="57" x="528.5" y="289.6694">userInvoice</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="129" x="487.5" y="313.8008">Stat-&gt;pend, Req=null</text></g><g id="peerDecline"><rect fill="#E8E8EA" filter="url(#f1i48knb0e5spg)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="147" x="564.5" y="421.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="564.5" x2="711.5" y1="442.1992" y2="442.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="58" x="609" y="434.6694">peerDecline</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="127" x="569.5" y="458.8008">Stat:-&gt;void, Req=null</text></g><!--MD5=[eb2730c87370629c3c3d87a1a2ccbb41]
link *start to void--><path d="M320,47.5592 C320,62.4092 320,91.9692 320,114.4092 " fill="none" id="*start-to-void" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="320,119.6592,324,110.6592,320,114.6592,316,110.6592,320,119.6592" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[33004218d0874c9ca02f8b378862cea7]
reverse link peerInvoice to void--><path d="M146.5,144.6992 C186.1,144.6992 234.16,144.6992 269.64,144.6992 " fill="none" id="peerInvoice-backto-void" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="141.22,144.6992,150.22,148.6992,146.22,144.6992,150.22,140.6992,141.22,144.6992" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="192.5" y="116.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="92" x="159.5" y="127.1694">Requests payment</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="177.5" y="138.1694">/Notify user</text><!--MD5=[fee529ca14ef31703213df1156ba08b7]
link void to userRequest--><path d="M370.27,144.6992 C406.13,144.6992 455.63,144.6992 499.76,144.6992 " fill="none" id="void-to-userRequest" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="504.83,144.6992,495.83,140.6992,499.83,144.6992,495.83,148.6992,504.83,144.6992" style="stroke:#008000;stroke-width:1.0;"/><text fill="#008000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="27" x="424" y="127.1694">User:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="98" x="388.5" y="138.1694">Creates chit Record</text><!--MD5=[5ddedc0eeeae4aa0951f280ca6b5b7e9]
link userRequest to userInvoice--><path d="M504.87,156.0492 C470.05,164.9892 434.27,181.3692 413,211.1992 C389.62,243.9892 432.51,267.1692 477.44,281.6392 " fill="none" id="userRequest-to-userInvoice" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="482.35,283.1892,474.9695,276.6679,477.5814,281.6856,472.5637,284.2976,482.35,283.1892" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="458.5" y="220.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="131" x="421" y="231.6694">Req:userRequest detected</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="145" x="414" y="242.6694">/Transmit chit Act:peerInvoice</text><!--MD5=[d335ab72b11f2dc2fc5f2dab1ce1c8c6]
link userInvoice to userRequest--><path d="M564.29,275.7292 C572.03,249.6992 584.34,208.3792 592.99,179.3092 " fill="none" id="userInvoice-to-userRequest" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="594.46,174.3992,588.0589,181.8843,593.0337,179.1915,595.7265,184.1663,594.46,174.3992" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="42" x="608.5" y="226.1694">Timeout:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="91" x="584" y="237.1694">No reply from peer</text><!--MD5=[d25a39a7bbfae4679619c7bda00c763f]
link userInvoice to peerDecline--><path d="M542.51,326.3892 C533.29,345.2092 525.11,371.3692 537,391.1992 C543.63,402.2692 553.39,411.1892 564.27,418.3492 " fill="none" id="userInvoice-to-peerDecline" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="568.65,421.1092,563.1578,412.9339,564.4164,418.4489,558.9014,419.7076,568.65,421.1092" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="553" y="365.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="42" x="545" y="376.6694">Declines</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="538" y="387.6694">/Notify user</text><!--MD5=[d25a39a7bbfae4679619c7bda00c763f]
link userInvoice to peerDecline--><path d="M577.8,326.2792 C585.03,335.3092 592.86,345.8892 599,356.1992 C610.36,375.2792 620.35,398.2692 627.37,416.0992 " fill="none" id="userInvoice-to-peerDecline-1" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="629.27,420.9892,629.7302,411.1511,627.455,416.3303,622.2759,414.0551,629.27,420.9892" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="633" y="365.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="42" x="625" y="376.6694">Declines</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="618" y="387.6694">/Notify user</text><!--MD5=[90e25901e122e04b472d56fa7a4112a8]
link peerDecline to userRequest--><path d="M664.04,421.1792 C671.64,412.5492 678.97,402.1992 683,391.1992 C734.46,250.5692 696.77,237.9492 684,211.1992 C677.82,198.2592 667.71,187.0592 656.68,177.7492 " fill="none" id="peerDecline-to-userRequest" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="652.58,174.4092,657.0268,183.197,656.4549,177.5692,662.0827,176.9972,652.58,174.4092" style="stroke:#008000;stroke-width:1.0;"/><text fill="#008000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="27" x="726.5" y="298.6694">User:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="60" x="710" y="309.6694">Modifies chit</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="148" x="308.5" y="493.8672">Thu Feb 11 08:17:48 MST 2021</text><!--MD5=[817f34fc34c3c2a48ebf84d69a51429e]
@startuml
!include common.puml

$title(Chit State Diagram)
[*] - -> void
state "void (or No Chit)" as void

'States are determined by a combination of values, as defined here:
userRequest: Stat: void, Req=>userRequest
userRequest : E: Store chit
peerInvoice: Stat: void, Req=null
peerInvoice : E: Store chit
userInvoice: Stat->pend, Req=null
peerDecline : Stat:->void, Req=null
peerInvoice : E: Update chit

'State transition rules:
void -left[$peer]-> peerInvoice : $trans($peer,Requests payment,'',Notify user)
void -right[$user]-> userRequest : $trans($user,Creates chit Record)

userRequest -[$db]-> userInvoice : $trans($db,Req:userRequest detected,'',Transmit chit Act:peerInvoice)
userInvoice - -> userRequest : $trans(Timeout,No reply from peer)
userInvoice -[$peer]-> peerDecline : $trans($peer,Declines,'',Notify user)
peerDecline -[$user]-> userRequest : $trans($user,Modifies chit,'')
userInvoice -[$peer]-> peerDecline : $trans($peer,Declines,'',Notify user)

'Fixme: Need to add more states here

'closed - -> [*]

@enduml

@startuml



skinparam backgroundColor fff
skinparam stereotypeCBackgroundColor 27d






skinparam circledCharacter {
  radius 8
  fontSize 11
  fontName Helvetica
}

skinparam class {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  attributeFontColor 333
  attributeFontSize 11
  attributeIconSize 11
}

skinparam actor {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam participant {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam collections {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam SequenceBox{
    backgroundColor e0e0e0
  borderColor cccccc
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam interface {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam component {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}



skinparam queue {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam usecase {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam activity {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam sequence {
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  lifeLineBorderColor 4af
  lifeLineBackgroundColor e0e0e0
}




skinparam state {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
  startColor 4af
  endColor 27d
}

skinparam note {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}








  title Chit State Diagram
  footer Thu Feb 11 08:17:48 MST 2021
[*] - -> void
state "void (or No Chit)" as void

userRequest: Stat: void, Req=>userRequest
userRequest : E: Store chit
peerInvoice: Stat: void, Req=null
peerInvoice : E: Store chit
userInvoice: Stat->pend, Req=null
peerDecline : Stat:->void, Req=null
peerInvoice : E: Update chit

void -left[#blue]-> peerInvoice : <font color=blue>Peer:\nRequests payment\n/Notify user
void -right[#green]-> userRequest : <font color=green>User:\nCreates chit Record

userRequest -[#red]-> userInvoice : <font color=red>DB Trigger:\nReq:userRequest detected\n/Transmit chit Act:peerInvoice
userInvoice - -> userRequest : <font color=black>Timeout:\nNo reply from peer
userInvoice -[#blue]-> peerDecline : <font color=blue>Peer:\nDeclines\n/Notify user
peerDecline -[#green]-> userRequest : <font color=green>User:\nModifies chit
userInvoice -[#blue]-> peerDecline : <font color=blue>Peer:\nDeclines\n/Notify user



@enduml

PlantUML version 1.2021.00(Sun Jan 10 03:25:05 MST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>