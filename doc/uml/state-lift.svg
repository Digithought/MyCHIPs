<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1078px" preserveAspectRatio="none" style="width:1190px;height:1078px;background:#FFFFFF;" version="1.1" viewBox="0 0 1190 1078" width="1190px" zoomAndPan="magnify"><defs><filter height="300%" id="f1d6i26syvsbul" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="88" x="544.5" y="17.4023">Lift States</text><!--MD5=[97a2ad4198554bc8d8f2bd96e1202341]
cluster signable--><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="538" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="948" x="7" y="510.1992"/><rect fill="#FFFFFF" height="511" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="942" x="10" y="534.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="7" x2="955" y1="531.1992" y2="531.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="40" x="461" y="522.6694">signable</text><!--MD5=[89851823b7e3ac9d3f854527fa321abc]
cluster origin--><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="304" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="575" x="39" y="556.1992"/><rect fill="#FFFFFF" height="257.8672" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="569" x="42" y="599.332"/><line style="stroke:#202024;stroke-width:1.5;" x1="39" x2="614" y1="596.332" y2="596.332"/><line style="stroke:#202024;stroke-width:1.5;" x1="39" x2="614" y1="577.1992" y2="577.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="197" y="568.6694">origin</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="259" x="44" y="591.3008">Should not get affirmed but might get voided</text><!--MD5=[4dc5522eab3f27dbb14e4d5b6f4371d5]
cluster relay--><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="304" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="277" x="638" y="556.1992"/><rect fill="#FFFFFF" height="257.8672" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="271" x="641" y="599.332"/><line style="stroke:#202024;stroke-width:1.5;" x1="638" x2="915" y1="596.332" y2="596.332"/><line style="stroke:#202024;stroke-width:1.5;" x1="638" x2="915" y1="577.1992" y2="577.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="703.5" y="568.6694">relay</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="146" x="643" y="591.3008">Any non-originating node</text><g id="signable.call"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="164" x="372" y="974.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="372" x2="536" y1="995.1992" y2="995.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="16" x="446" y="987.6694">call</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="144" x="377" y="1011.8008">Status: call, Request: null</text></g><g id="signable.callCall"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="163" x="651.5" y="974.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="651.5" x2="814.5" y1="995.1992" y2="995.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="35" x="715.5" y="987.6694">call.call</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="143" x="656.5" y="1011.8008">Status: call, Request: call</text></g><g id="signable.origin.seek"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="172" x="195" y="605.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="195" x2="367" y1="626.1992" y2="626.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="269" y="618.6694">seek</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="152" x="200" y="642.8008">Status: seek, Request: null</text></g><g id="signable.origin.seekCheck"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="185" x="90.5" y="794.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="90.5" x2="275.5" y1="815.1992" y2="815.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="57" x="154.5" y="807.6694">seek.check</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="165" x="95.5" y="831.8008">Status: seek, Request: check</text></g><g id="signable.origin.seekCall"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="171" x="368.5" y="794.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="368.5" x2="539.5" y1="815.1992" y2="815.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="43" x="432.5" y="807.6694">seek.call</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="151" x="373.5" y="831.8008">Status: seek, Request: call</text></g><g id="signable.relay.pend"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="175" x="654.5" y="605.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="654.5" x2="829.5" y1="626.1992" y2="626.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="730" y="618.6694">pend</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="155" x="659.5" y="642.8008">Status: pend, Request: null</text></g><g id="signable.relay.pendCheck"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="188" x="682" y="794.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="682" x2="870" y1="815.1992" y2="815.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="57" x="747.5" y="807.6694">pend.check</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="168" x="687" y="831.8008">Status: pend, Request: check</text></g><g id="draftInit"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="170" x="196" y="173.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="196" x2="366" y1="194.1992" y2="194.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="38" x="262" y="186.6694">draft.init</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="150" x="201" y="210.8008">Status: draft, Request: init</text></g><g id="initSeek"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="169" x="196.5" y="349.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="196.5" x2="365.5" y1="370.1992" y2="370.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="40" x="261" y="362.6694">init.seek</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="149" x="201.5" y="386.8008">Status: init, Request: seek</text></g><g id="draftRelay"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="181" x="651.5" y="349.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="651.5" x2="832.5" y1="370.1992" y2="370.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="49" x="717.5" y="362.6694">draft.relay</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="161" x="656.5" y="386.8008">Status: draft, Request: relay</text></g><g id="draftFound"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="186" x="459" y="173.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="459" x2="645" y1="194.1992" y2="194.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="52" x="526" y="186.6694">draft.found</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="166" x="464" y="210.8008">Status: draft, Request: found</text></g><g id="foundTerm"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="185" x="431.5" y="349.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="431.5" x2="616.5" y1="370.1992" y2="370.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="52" x="498" y="362.6694">found.term</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="165" x="436.5" y="386.8008">Status: found, Request: term</text></g><g id="good"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="174" x="868" y="349.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="868" x2="1042" y1="370.1992" y2="370.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="943" y="362.6694">good</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="154" x="873" y="386.8008">Status: good, Request: null</text></g><g id="void"><rect fill="#E8E8EA" filter="url(#f1d6i26syvsbul)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="169" x="979.5" y="794.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="979.5" x2="1148.5" y1="815.1992" y2="815.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="20" x="1054" y="807.6694">void</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="149" x="984.5" y="831.8008">Status: void, Request: null</text></g><ellipse cx="662" cy="37.1992" fill="#44AAFF" filter="url(#f1d6i26syvsbul)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><ellipse cx="1132" cy="198.1992" fill="none" filter="url(#f1d6i26syvsbul)" rx="10" ry="10" style="stroke:#2277DD;stroke-width:1.0;"/><ellipse cx="1132.5" cy="198.6992" fill="#2277DD" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><!--MD5=[308a85f2e00e6107d378f5bcee9a465c]
link *start to draftInit--><path d="M652.09,39.0192 C614.16,42.2992 478.54,55.3492 442,77.1992 C414.3,93.7692 421.69,113.4092 397,134.1992 C380.2,148.3592 359.71,160.7392 340.65,170.6992 " fill="none" id="*start-to-draftInit" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="335.84,173.1792,345.6714,172.5938,340.2803,170.8806,341.9936,165.4894,335.84,173.1792" style="stroke:#008000;stroke-width:1.0;"/><text fill="#008000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="27" x="482" y="97.6694">User:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="105" x="443" y="108.6694">User initiates linear lift</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="57" x="467" y="119.6694">Request:init</text><!--MD5=[308a85f2e00e6107d378f5bcee9a465c]
link *start to draftInit--><path d="M652.03,38.3492 C591.26,39.3392 272.41,46.0192 244,77.1992 C220.87,102.5892 240.23,142.1892 258.54,168.8792 " fill="none" id="*start-to-draftInit-1" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="261.46,173.0492,259.5576,163.3858,258.585,168.9584,253.0124,167.9858,261.46,173.0492" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="31" x="301" y="97.6694">Agent:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="143" x="245" y="108.6694">Automaton initiates circular lift</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="57" x="288" y="119.6694">Request:init</text><!--MD5=[a06f9a57bd8aceb56702304eedc9b43c]
link draftInit to initSeek--><path d="M281,223.3892 C281,254.8592 281,309.7992 281,343.6792 " fill="none" id="draftInit-to-initSeek" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="281,348.9292,285,339.9292,281,343.9292,277,339.9292,281,348.9292" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="319" y="271.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="58" x="318" y="282.6694">init detected</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="130" x="282" y="293.6694">/Agent prepares Lift Object</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="98" x="298" y="304.6694">Encodes destination</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="68" x="313" y="315.6694">Request:seek</text><!--MD5=[39eccbf979fcee901bb2460e56aa5a61]
link initSeek to seek--><path d="M281,399.5492 C281,446.4892 281,549.2992 281,599.8992 " fill="none" id="initSeek-to-seek" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="281,604.9192,285,595.9192,281,599.9192,277,595.9192,281,604.9192" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="297" y="438.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="69" x="290.5" y="449.6694">seek detected</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="285.5" y="460.6694">/Send Upstream</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="72" x="289" y="471.6694">Action:promise</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="86" x="282" y="482.6694">Agent starts timer</text><!--MD5=[64d1d8889952e8a00e0e3ea68b831c86]
link seek to seekCall--><path d="M290.12,655.4692 C303.84,691.5392 329.03,755.9592 337,764.1992 C347.76,775.3292 361.24,784.3792 375.2,791.6792 " fill="none" id="seek-to-seekCall" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="379.95,794.0792,373.728,786.4447,375.4894,791.8203,370.1137,793.5817,379.95,794.0792" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="391" y="711.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="104" x="352" y="722.1694">Receive confirm from</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="130" x="339" y="733.1694">destination Action:terminus</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="132" x="338" y="744.1694">/Circuit good, freshen route</text><!--MD5=[189518bbdf603587fdf1693b8b4b362b]
link seekCall to seek--><path d="M467.66,793.9692 C481.89,765.1092 499.04,716.8392 475,685.1992 C461.89,667.9392 415.98,654.7392 372.12,645.6992 " fill="none" id="seekCall-to-seek" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="367.06,644.6792,375.0944,650.3756,371.9618,645.6653,376.6721,642.5327,367.06,644.6792" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="502" y="705.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="51" x="504.5" y="716.6694">Detect call</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="82" x="489" y="727.6694">[Change of mind]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="69" x="495.5" y="738.6694">/want to abort;</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="80" x="490" y="749.6694">will await timeout</text><!--MD5=[d27d9978d30cb01b698ef30a4784069a]
link seekCall to call--><path d="M454,844.2092 C454,876.4492 454,933.7292 454,968.6092 " fill="none" id="seekCall-to-call" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="454,974.0092,458,965.0092,454,969.0092,450,965.0092,454,974.0092" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="470" y="885.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="51" x="472.5" y="896.6694">Detect call</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="86" x="455" y="907.6694">[Want to proceed]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="72" x="462" y="918.6694">/Query referee</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="82" x="457" y="929.6694">Request: commit</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="458.5" y="940.6694">Agent sets timer</text><!--MD5=[be7e069f2bb5ac95aef9635f5b133abf]
link call to callCall--><path d="M497,1024.2892 C515.64,1033.7792 538.11,1043.4292 559.75,1048.1992 C589.26,1054.7092 598.24,1054.7292 627.75,1048.1992 C647.45,1043.8392 667.83,1035.3992 685.35,1026.7292 " fill="none" id="call-to-callCall" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="690.22,1024.2892,680.3831,1024.7741,685.7565,1026.5424,683.9881,1031.9158,690.22,1024.2892" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="31" x="578.25" y="1011.6694">Agent:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="561.75" y="1022.6694">Local timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="58" x="564.75" y="1033.6694">[Still in call?]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="66" x="560.75" y="1044.6694">/Request: call</text><!--MD5=[d1dc16109fe0f11b406ca0cdabc6a78f]
reverse link call to callCall--><path d="M541.35,999.1992 C576.51,999.1992 616.83,999.1992 651.39,999.1992 " fill="none" id="call-backto-callCall" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="536.2,999.1992,545.2,1003.1992,541.2,999.1992,545.2,995.1992,536.2,999.1992" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="565.75" y="937.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="51" x="568.25" y="948.6694">Detect call</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="55" x="566.25" y="959.6694">[Still calling]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="75" x="556.25" y="970.6694">/Query referee;</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="71" x="558.25" y="981.6694">Action: commit</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="554.25" y="992.6694">Agent sets timer</text><!--MD5=[d926a0890e87a5e32de3cf9d5db86af8]
link seek to seekCheck--><path d="M243.02,655.3592 C232.57,663.6692 222.16,673.7892 215,685.1992 C195.03,717.0092 187.52,760.2792 184.7,788.7092 " fill="none" id="seek-to-seekCheck" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="184.22,793.8392,189.0251,785.242,184.6765,788.8601,181.0585,784.5116,184.22,793.8392" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="31" x="240.5" y="711.1694">Agent:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="224" y="722.1694">Local timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="65" x="223.5" y="733.1694">[Lift expired?]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="80" x="216" y="744.1694">/Request: check</text><!--MD5=[2e506280d62b645a29fbaaae9bab07dc]
link seekCheck to seek--><path d="M123.13,794.1192 C111.09,786.4092 100,776.5692 93,764.1992 C75.7,733.6492 71.88,713.2492 93,685.1992 C105.37,668.7792 148.09,655.8092 189.69,646.6992 " fill="none" id="seekCheck-to-seek" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="194.75,645.6092,185.1076,643.603,189.8631,646.6666,186.7995,651.4221,194.75,645.6092" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="109" y="700.1694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="65" x="104.5" y="711.1694">Detect check</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="63" x="105.5" y="722.1694">[Still seeking]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="75" x="99.5" y="733.1694">/Query referee;</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="66" x="104" y="744.1694">Action: check</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="86" x="94" y="755.1694">Agent starts timer</text><!--MD5=[3d2416266f95920db2c6e65a49de3d74]
link *start to *end--><path d="M672.17,38.7792 C719.53,41.5592 918.55,54.4192 976,77.1992 C1039.66,102.4392 1099.25,161.6992 1122.13,186.2492 " fill="none" id="*start-to-*end" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1125.73,190.1492,1122.5692,180.8213,1122.3404,186.4736,1116.6882,186.2447,1125.73,190.1492" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="1111.5" y="92.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="115" x="1067" y="103.1694">Receive Action:promise</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="108" x="1070.5" y="114.1694">[Destination not found]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="68" x="1090.5" y="125.1694">/Give no reply</text><!--MD5=[0776b33b061fa3c1ca593c267c4e9909]
link *start to draftRelay--><path d="M671.4,41.4792 C684.81,46.7092 709.02,58.3192 720,77.1992 C769.92,163.0892 757.13,287.4792 747.77,343.6792 " fill="none" id="*start-to-draftRelay" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="746.88,348.8992,752.3399,340.7023,747.7228,343.9708,744.4543,339.3537,746.88,348.8992" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="812" y="173.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="115" x="767.5" y="184.6694">Receive Action:promise</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="136" x="757" y="195.6694">[Route found for destination]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="116" x="767" y="206.6694">/Store lift Request:relay;</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="119" x="765.5" y="217.6694">Forward Action: promise</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="785.5" y="228.6694">Agent sets timer</text><!--MD5=[a99dfd0520800cf091fc809bfe5456ce]
link *start to draftFound--><path d="M652.21,39.9892 C634.86,43.6892 598.79,53.8692 580,77.1992 C559.24,102.9692 553.35,141.4092 551.93,167.7992 " fill="none" id="*start-to-draftFound" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="551.71,172.9092,556.0917,164.0887,551.9241,167.9138,548.099,163.7462,551.71,172.9092" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="635" y="86.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="115" x="590.5" y="97.6694">Receive Action:promise</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="123" x="586.5" y="108.6694">[Destination found locally]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="134" x="581" y="119.6694">/Store lift Request: terminus</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="608.5" y="130.6694">Agent sets timer</text><!--MD5=[4863f677f03f417c86444c3a34c7e126]
link draftFound to foundTerm--><path d="M548.11,223.3892 C543.04,254.8592 534.2,309.7992 528.75,343.6792 " fill="none" id="draftFound-to-foundTerm" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="527.91,348.9292,533.2733,340.6688,528.6949,343.9912,525.3725,339.4129,527.91,348.9292" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="563" y="271.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="62" x="560" y="282.6694">Detect found</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="559" y="293.6694">/Build draft lift</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="96" x="543" y="304.6694">Notify correct agent</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="63" x="559.5" y="315.6694">Action: found</text><!--MD5=[6eb2186b7d440f87972eab1024baef30]
link foundTerm to pend--><path d="M544.9,399.5492 C585.51,446.8692 674.86,550.9692 717.89,601.1092 " fill="none" id="foundTerm-to-pend" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="721.16,604.9192,718.3428,595.4819,717.9072,601.1219,712.2672,600.6863,721.16,604.9192" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="632.5" y="438.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="77" x="622" y="449.6694">Detect terminus</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="91" x="615" y="460.6694">/Reply to originator</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="49" x="636" y="471.6694">Build chits</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="78" x="621.5" y="482.6694">Action: terminus</text><!--MD5=[b03d74ce3a0bbb16ba9cbc404769b27f]
link draftRelay to pend--><path d="M742,399.5492 C742,446.4892 742,549.2992 742,599.8992 " fill="none" id="draftRelay-to-pend" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="742,604.9192,746,595.9192,742,599.9192,738,595.9192,742,604.9192" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="752.5" y="444.1694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="59" x="751" y="455.1694">Detect relay</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="57" x="752" y="466.1694">/Forward lift</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="75" x="743" y="477.1694">Action: promise</text><!--MD5=[9b0a0245deffef3540f070ad5e624804]
link pend to pendCheck--><path d="M708.48,655.2092 C699.46,663.5692 690.86,673.7592 686,685.1992 C672.27,717.5092 668.7,733.6492 686,764.1992 C692.18,775.1192 701.55,784.0692 711.94,791.3192 " fill="none" id="pend-to-pendCheck" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="716.13,794.1192,710.8801,785.7862,711.9763,791.3358,706.4267,792.4321,716.13,794.1192" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="31" x="711.5" y="711.1694">Agent:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="695" y="722.1694">Local timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="63" x="695.5" y="733.1694">[Still pending]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="80" x="687" y="744.1694">/Request: check</text><!--MD5=[4fce0619015f2e8f833d4365386cd6ba]
link pendCheck to pend--><path d="M778.64,794.1492 C780.84,767.1192 782.18,722.1692 772,685.1992 C769.64,676.6392 765.67,667.9592 761.38,660.1492 " fill="none" id="pendCheck-to-pend" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="758.67,655.3992,759.6449,665.1997,761.143,659.7448,766.5979,661.2429,758.67,655.3992" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="796" y="694.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="65" x="791.5" y="705.6694">Detect check</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="63" x="792.5" y="716.6694">[Still pending]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="75" x="786.5" y="727.6694">/Query partner,</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="86" x="781" y="738.6694">originator, referee</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="59" x="794.5" y="749.6694">in sequence</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="66" x="791" y="760.6694">Action: check</text><!--MD5=[eac544136ba7e66a0445303d1eb1ff29]
link *start to good--><path d="M671.74,40.1492 C708.59,48.0792 840.5,81.4992 902,164.1992 C942.46,218.6092 952.2,300.6592 954.43,343.9892 " fill="none" id="*start-to-good" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="954.67,349.0792,958.2548,339.9059,954.4417,344.0844,950.2632,340.2713,954.67,349.0792" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="31" x="987" y="184.6694">Agent:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="109" x="948" y="195.6694">Call to local lift function</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="73" x="966" y="206.6694">[Lift completes]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="135" x="935" y="217.6694">/Commit lift chits; Consense</text><!--MD5=[3433976049688620fb9a328169b87d4c]
reverse link good to signable--><path d="M954.06,404.9092 C953.5425,421.3992 952.8525,443.348 952.1061,467.0722 C951.7329,478.9343 951.3456,491.2403 950.9587,503.5297 C950.9103,505.0659 950.862,506.6018 950.8137,508.1366 C950.8016,508.5203 950.7895,508.9039 950.7774,509.2874 " fill="none" id="good-backto-signable" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="954.23,399.5492,949.9485,408.4187,954.0725,404.5467,957.9445,408.6708,954.23,399.5492" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="1008.5" y="444.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="126" x="958.5" y="455.1694">Receive referee signature</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="68" x="987.5" y="466.1694">[Verified Valid]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="135" x="954" y="477.1694">/Commit lift chits; Consense</text><!--MD5=[9abc0c8fb63ef3ddcc818ab4a621ca0a]
link signable to void--><path d="M955.2618,644.4095 C955.3535,644.556 955.4459,644.7036 955.5389,644.8523 C955.911,645.4468 956.2934,646.0579 956.6859,646.6851 C957.4709,647.9394 958.2961,649.2579 959.1584,650.6359 C966.0575,661.6602 975.3413,676.4961 985.545,692.803 C1005.9525,725.4167 1030.04,763.9142 1046.09,789.5692 " fill="none" id="signable-to-void" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1048.9,794.0692,1047.4984,784.3206,1046.2397,789.8357,1040.7247,788.577,1048.9,794.0692" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="1080" y="711.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="126" x="1030" y="722.1694">Receive referee signature</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="66" x="1060" y="733.1694">[Verified Void]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="1053.5" y="744.1694">/Mark lift as void</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="152" x="512.5" y="1070.3972">Thu Mar 31 15:47:01 MDT 2022</text><!--MD5=[12a18299d1712f8c7a4b6b0bc3faa32a]
@startuml
!include common.puml

$title(Lift States)
state "draft.init" as draftInit
state "init.seek" as initSeek
state "draft.relay" as draftRelay
state "draft.found" as draftFound
state "found.term" as foundTerm
state signable {
  state origin {
    state seek
    state "seek.check" as seekCheck
    state "seek.call" as seekCall
  }
  state call
  state "call.call" as callCall
  state relay {
    state pend
    state "pend.check" as pendCheck
  }
}

draftInit: Status: draft, Request: init
initSeek: Status: init, Request: seek
draftFound:  Status: draft, Request: found
foundTerm:  Status: found, Request: term
draftRelay:  Status: draft, Request: relay
seek:  Status: seek, Request: null
seekCheck:  Status: seek, Request: check
seekCall:  Status: seek, Request: call
call:  Status: call, Request: null
callCall:  Status: call, Request: call
good:  Status: good, Request: null
pend:  Status: pend, Request: null
void:  Status: void, Request: null
pendCheck:  Status: pend, Request: check
origin: Should not get affirmed but might get voided
relay: Any non-originating node

'State transition rules:
[*] -[$user]-> draftInit: $trans($user,User initiates linear lift\nRequest:init,'')
[*] - -> draftInit: $trans(Agent,Automaton initiates circular lift\nRequest:init,'')
draftInit -[$db]-> initSeek: $trans($db, init detected, '', Agent prepares Lift Object\nEncodes destination\nRequest:seek)
initSeek -[$db]-> seek: $trans($db, seek detected,'',Send Upstream\nAction:promise\nAgent starts timer)

seek -[$peer]-> seekCall: $trans($peer,'Receive confirm from\ndestination Action:terminus','', 'Circuit good, freshen route')
seekCall -[$db]-> seek: $trans($db,Detect call, Change of mind, want to abort;\nwill await timeout)
seekCall -[$db]-> call: $trans($db,Detect call, Want to proceed, Query referee\nRequest: commit\nAgent sets timer)
call -right-> callCall: $trans(Agent, Local timeout, Still in call?, Request: call)
callCall -left[$db]-> call: $trans($db,Detect call, Still calling, Query referee;\nAction: commit\nAgent sets timer)

seek - -> seekCheck: $trans(Agent,Local timeout,Lift expired?, Request: check)
seekCheck -[$db]-> seek: $trans($db,Detect check, Still seeking, Query referee;\nAction: check\nAgent starts timer)

[*] -[$peer]-> [*]: $trans($peer,Receive Action:promise, Destination not found, Give no reply)
[*] -[$peer]-> draftRelay: $trans($peer,Receive Action:promise,Route found for destination, 'Store lift Request:relay;\nForward Action: promise\nAgent sets timer')
[*] -[$peer]-> draftFound: $trans($peer,Receive Action:promise,Destination found locally, 'Store lift Request: terminus\nAgent sets timer')

draftFound -[$db]-> foundTerm: $trans($db,Detect found,'', Build draft lift\nNotify correct agent\nAction: found)
foundTerm -[$db]-> pend: $trans($db,Detect terminus,'', Reply to originator\nBuild chits\nAction: terminus)
draftRelay -[$db]-> pend: $trans($db,Detect relay,'', Forward lift\nAction: promise)

pend - -> pendCheck: $trans(Agent, Local timeout, Still pending, Request: check)
pendCheck -[$db]-> pend: $trans($db, Detect check, Still pending, 'Query partner,\noriginator, referee\nin sequence\nAction: check')

[*] - -> good: $trans(Agent, Call to local lift function, Lift completes, Commit lift chits; Consense)

signable -up[$peer]-> good: $trans($peer,Receive referee signature, Verified Valid, Commit lift chits; Consense)
signable -[$peer]-> void: $trans($peer,Receive referee signature, Verified Void, Mark lift as void)

@enduml

@startuml



skinparam backgroundColor fff
skinparam stereotypeCBackgroundColor 27d






skinparam circledCharacter {
  radius 8
  fontSize 11
  fontName Helvetica
}

skinparam class {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  attributeFontColor 333
  attributeFontSize 11
  attributeIconSize 11
}

skinparam actor {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam participant {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam collections {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam SequenceBox{
    backgroundColor e0e0e0
  borderColor cccccc
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam interface {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam component {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}



skinparam queue {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam usecase {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam activity {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam sequence {
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  lifeLineBorderColor 4af
  lifeLineBackgroundColor e0e0e0
}




skinparam state {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
  startColor 4af
  endColor 27d
}

skinparam note {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}








  title Lift States
  footer Thu Mar 31 15:47:01 MDT 2022
state "draft.init" as draftInit
state "init.seek" as initSeek
state "draft.relay" as draftRelay
state "draft.found" as draftFound
state "found.term" as foundTerm
state signable {
  state origin {
    state seek
    state "seek.check" as seekCheck
    state "seek.call" as seekCall
  }
  state call
  state "call.call" as callCall
  state relay {
    state pend
    state "pend.check" as pendCheck
  }
}

draftInit: Status: draft, Request: init
initSeek: Status: init, Request: seek
draftFound:  Status: draft, Request: found
foundTerm:  Status: found, Request: term
draftRelay:  Status: draft, Request: relay
seek:  Status: seek, Request: null
seekCheck:  Status: seek, Request: check
seekCall:  Status: seek, Request: call
call:  Status: call, Request: null
callCall:  Status: call, Request: call
good:  Status: good, Request: null
pend:  Status: pend, Request: null
void:  Status: void, Request: null
pendCheck:  Status: pend, Request: check
origin: Should not get affirmed but might get voided
relay: Any non-originating node

[*] -[#green]-> draftInit: <font color=green>User:\nUser initiates linear lift\nRequest:init
[*] - -> draftInit: <font color=black>Agent:\nAutomaton initiates circular lift\nRequest:init
draftInit -[#red]-> initSeek: <font color=red>DB Trigger:\ninit detected\n/Agent prepares Lift Object\nEncodes destination\nRequest:seek
initSeek -[#red]-> seek: <font color=red>DB Trigger:\nseek detected\n/Send Upstream\nAction:promise\nAgent starts timer

seek -[#blue]-> seekCall: <font color=blue>Peer:\nReceive confirm from\ndestination Action:terminus\n/Circuit good, freshen route
seekCall -[#red]-> seek: <font color=red>DB Trigger:\nDetect call\n[Change of mind]\n/want to abort;\nwill await timeout
seekCall -[#red]-> call: <font color=red>DB Trigger:\nDetect call\n[Want to proceed]\n/Query referee\nRequest: commit\nAgent sets timer
call -right-> callCall: <font color=black>Agent:\nLocal timeout\n[Still in call?]\n/Request: call
callCall -left[#red]-> call: <font color=red>DB Trigger:\nDetect call\n[Still calling]\n/Query referee;\nAction: commit\nAgent sets timer

seek - -> seekCheck: <font color=black>Agent:\nLocal timeout\n[Lift expired?]\n/Request: check
seekCheck -[#red]-> seek: <font color=red>DB Trigger:\nDetect check\n[Still seeking]\n/Query referee;\nAction: check\nAgent starts timer

[*] -[#blue]-> [*]: <font color=blue>Peer:\nReceive Action:promise\n[Destination not found]\n/Give no reply
[*] -[#blue]-> draftRelay: <font color=blue>Peer:\nReceive Action:promise\n[Route found for destination]\n/Store lift Request:relay;\nForward Action: promise\nAgent sets timer
[*] -[#blue]-> draftFound: <font color=blue>Peer:\nReceive Action:promise\n[Destination found locally]\n/Store lift Request: terminus\nAgent sets timer

draftFound -[#red]-> foundTerm: <font color=red>DB Trigger:\nDetect found\n/Build draft lift\nNotify correct agent\nAction: found
foundTerm -[#red]-> pend: <font color=red>DB Trigger:\nDetect terminus\n/Reply to originator\nBuild chits\nAction: terminus
draftRelay -[#red]-> pend: <font color=red>DB Trigger:\nDetect relay\n/Forward lift\nAction: promise

pend - -> pendCheck: <font color=black>Agent:\nLocal timeout\n[Still pending]\n/Request: check
pendCheck -[#red]-> pend: <font color=red>DB Trigger:\nDetect check\n[Still pending]\n/Query partner,\noriginator, referee\nin sequence\nAction: check

[*] - -> good: <font color=black>Agent:\nCall to local lift function\n[Lift completes]\n/Commit lift chits; Consense

signable -up[#blue]-> good: <font color=blue>Peer:\nReceive referee signature\n[Verified Valid]\n/Commit lift chits; Consense
signable -[#blue]-> void: <font color=blue>Peer:\nReceive referee signature\n[Verified Void]\n/Mark lift as void

@enduml

PlantUML version 1.2022.1(Tue Feb 01 11:19:58 MST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>