<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1265px" preserveAspectRatio="none" style="width:1580px;height:1265px;" version="1.1" viewBox="0 0 1580 1265" width="1580px" zoomAndPan="magnify"><defs><filter height="300%" id="f1pkyexs3f57wv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="88" x="739.545" y="17.4023">Lift States</text><!--MD5=[97a2ad4198554bc8d8f2bd96e1202341]
cluster signable--><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="528.36" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="394" x="785.09" y="707.8392"/><rect fill="#FFFFFF" height="501.36" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="388" x="788.09" y="731.8392"/><line style="stroke:#202024;stroke-width:1.5;" x1="785.09" x2="1179.09" y1="728.8392" y2="728.8392"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="40" x="962.09" y="720.3094">signable</text><g id="signable.pend"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="141" x="992.59" y="872.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="992.59" x2="1133.59" y1="893.1992" y2="893.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="1051.09" y="885.6694">pend</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="121" x="997.59" y="909.8008">Stat: pend, Req: N/A</text></g><g id="signable.checkProp"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="178" x="809.09" y="1017.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="809.09" x2="987.09" y1="1038.1992" y2="1038.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="53" x="871.59" y="1030.6694">checkProp</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="158" x="814.09" y="1054.8008">Stat: pend, Req: N/A, Time</text></g><g id="signable.checkRef"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="178" x="925.09" y="1162.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="925.09" x2="1103.09" y1="1183.1992" y2="1183.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="47" x="990.59" y="1175.6694">checkRef</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="158" x="930.09" y="1199.8008">Stat: pend, Req: N/A, Time</text></g><ellipse cx="1183.09" cy="37.1992" fill="#44AAFF" filter="url(#f1pkyexs3f57wv)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><g id="none"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="51" x="1157.59" y="111.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="1157.59" x2="1208.59" y1="132.1992" y2="132.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="31" x="1167.59" y="124.6694">No Lift</text></g><g id="draft"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="140" x="961.09" y="248.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="961.09" x2="1101.09" y1="269.1992" y2="269.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="22" x="1020.09" y="261.6694">draft</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="966.09" y="285.8008">Stat: void, Req: draft</text></g><g id="seek"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="138" x="223.09" y="393.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="223.09" x2="361.09" y1="414.1992" y2="414.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="280.09" y="406.6694">seek</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="228.09" y="430.8008">Stat: seek, Req: N/A</text></g><g id="term"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="138" x="470.09" y="549.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="470.09" x2="608.09" y1="570.1992" y2="570.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="22" x="528.09" y="562.6694">term</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="475.09" y="586.8008">Stat: term, Req: N/A</text></g><g id="call"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="130" x="361.09" y="705.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="361.09" x2="491.09" y1="726.1992" y2="726.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="16" x="418.09" y="718.6694">call</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="110" x="366.09" y="742.8008">Stat: call, Req: N/A</text></g><g id="good"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="140" x="621.09" y="872.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="621.09" x2="761.09" y1="893.1992" y2="893.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="679.09" y="885.6694">good</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="626.09" y="909.8008">Stat: good, Req: N/A</text></g><g id="void"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="135" x="139.59" y="872.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="139.59" x2="274.59" y1="893.1992" y2="893.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="20" x="197.09" y="885.6694">void</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="115" x="144.59" y="909.8008">Stat: void, Req: N/A</text></g><g id="local"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="138" x="1378.09" y="705.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="1378.09" x2="1516.09" y1="726.1992" y2="726.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="22" x="1436.09" y="718.6694">local</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="1383.09" y="742.8008">Stat: void, Req: local</text></g><g id="relay"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="140" x="1203.09" y="705.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="1203.09" x2="1343.09" y1="726.1992" y2="726.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="24" x="1261.09" y="718.6694">relay</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="1208.09" y="742.8008">Stat: void, Req: relay</text></g><g id="timeCheck"><rect fill="#E8E8EA" filter="url(#f1pkyexs3f57wv)" height="50" rx="12.5" ry="12.5" style="stroke:#202024;stroke-width:1.5;" width="175" x="90.59" y="549.1992"/><line style="stroke:#202024;stroke-width:1.5;" x1="90.59" x2="265.59" y1="570.1992" y2="570.1992"/><text fill="#000033" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="52" x="152.09" y="562.6694">timeCheck</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="155" x="95.59" y="586.8008">Stat: seek, Req: N/A, Time</text></g><!--MD5=[0ed2e745026fd0d436b1b77e9cdb1882]
link *start to none--><path d="M1183.09,47.4992 C1183.09,60.8192 1183.09,85.9192 1183.09,105.8692 " fill="none" id="*start-to-none" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1183.09,111.0792,1187.09,102.0792,1183.09,106.0792,1179.09,102.0792,1183.09,111.0792" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[b8a2bd5f8bd0f500837135ebc7426c67]
link none to draft--><path d="M1157.32,138.3692 C1121.99,141.5192 1059.67,152.9692 1031.09,194.1992 C1021.46,208.0992 1021.23,226.9992 1023.51,242.7092 " fill="none" id="none-to-draft" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="1024.37,247.9092,1026.8494,238.3776,1023.555,242.9761,1018.9564,239.6816,1024.37,247.9092" style="stroke:#008000;stroke-width:1.0;"/><text fill="#008000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="27" x="1080.59" y="203.6694">User:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="124" x="1032.09" y="214.6694">User initiates lift Req:draft</text><!--MD5=[3a463f2653b48a5c7d220ce005e98019]
link draft to seek--><path d="M960.9,287.7792 C821.15,314.8292 509.27,375.1792 366.29,402.8392 " fill="none" id="draft-to-seek" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="361.28,403.8092,370.8787,406.0149,366.1878,402.8533,369.3493,398.1624,361.28,403.8092" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="786.59" y="337.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="67" x="781.09" y="348.6694">draft detected</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="129" x="750.09" y="359.6694">/Send Upstream Act:query</text><!--MD5=[5e0422283bf9db92b2a93d1b3a79d7ae]
link seek to void--><path d="M222.77,424.4092 C182.94,430.6192 134.21,444.0992 100.09,473.1992 C42,522.7592 44.47,554.6192 28.09,629.1992 C6,729.8092 108.81,824.1292 167.9,868.9392 " fill="none" id="seek-to-void" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="172.08,872.0792,167.28,863.4792,168.08,869.0792,162.48,869.8792,172.08,872.0792" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="88.59" y="644.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="75" x="64.09" y="655.1694">Receive Act:fail</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="145" x="29.09" y="666.1694">/Lift failed; Notify referee, user</text><!--MD5=[3c336d3e22ec20b52cea399caff4388a]
link seek to timeCheck--><path d="M286.82,443.3692 C281.21,464.9392 270.67,496.5192 253.09,519.1992 C245.28,529.2792 235.1,538.2992 224.76,545.9492 " fill="none" id="seek-to-timeCheck" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="220.64,548.9292,230.2786,546.905,224.6941,546.0028,225.5963,540.4184,220.64,548.9292" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="352.59" y="488.1694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="348.59" y="499.1694">Local timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="205" x="278.09" y="510.1694">/Lift expired?; Request status from referee</text><!--MD5=[c01631737c1f0f8b3ba4fe1ccf7e9ef8]
link timeCheck to seek--><path d="M139.48,549.1092 C129.7,540.9192 120.45,530.8492 115.09,519.1992 C106.55,500.6292 102.93,489.6292 115.09,473.1992 C138.69,441.3192 180.7,427.6292 217.86,421.9992 " fill="none" id="timeCheck-to-seek" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="222.84,421.2892,213.3604,418.6175,217.8914,422.0043,214.5046,426.5353,222.84,421.2892" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="167.09" y="488.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="128" x="116.09" y="499.1694">Receive referee Act:intime</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="92" x="134.09" y="510.1694">/Lift not yet expired</text><!--MD5=[6b1400eb778514d0b125ba8b112026ab]
link timeCheck to void--><path d="M179.98,599.5192 C183.68,646.4592 192.28,752.8392 201.09,842.1992 C201.87,850.1292 202.79,858.7092 203.68,866.6492 " fill="none" id="timeCheck-to-void" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="204.28,872.0192,207.2528,862.6297,203.7231,867.0503,199.3025,863.5207,204.28,872.0192" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="248.59" y="722.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="135" x="194.09" y="733.1694">Receive referee Act:timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="95" x="214.09" y="744.1694">/Mark lift as expired</text><!--MD5=[482d6309deee2766415261c82560d726]
link seek to term--><path d="M361.32,423.3992 C403.28,429.1992 455.57,442.5892 492.09,473.1992 C513.69,491.2992 525.98,521.5492 532.53,544.0492 " fill="none" id="seek-to-term" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="533.92,549.0192,535.3548,539.2754,532.5766,544.2031,527.649,541.4248,533.92,549.0192" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="577.09" y="482.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="104" x="538.09" y="493.6694">Receive confirm from</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="116" x="532.09" y="504.6694">destination Act:terminus</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="132" x="524.09" y="515.6694">/Circuit good, freshen route</text><!--MD5=[f762aa6b86640f97b061015827f08e19]
link term to call--><path d="M469.78,577.4592 C431.75,582.6992 387.51,596.1692 363.09,629.1992 C350.94,645.6392 354.55,656.6292 363.09,675.1992 C367.7,685.2092 375.17,694.0592 383.39,701.5492 " fill="none" id="term-to-call" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="387.48,705.1092,383.3384,696.1735,383.7162,701.8177,378.072,702.1955,387.48,705.1092" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="408.59" y="638.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="397.09" y="649.6694">Detect loopback</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="85" x="394.09" y="660.6694">[Lift still desirable]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="145" x="364.09" y="671.6694">/Request commit from referee</text><!--MD5=[f762aa6b86640f97b061015827f08e19]
link term to call--><path d="M538.11,599.5892 C536.13,621.2992 530.39,652.9792 514.09,675.1992 C506.33,685.7892 495.8,694.7392 484.72,702.1292 " fill="none" id="term-to-call-1" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="480.29,704.9892,490.02,703.4637,484.4894,702.2753,485.6778,696.7447,480.29,704.9892" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="561.59" y="638.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="79" x="550.09" y="649.6694">Detect loopback</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="82" x="548.59" y="660.6694">[Change of mind]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="109" x="535.09" y="671.6694">/Notify referee of abort</text><!--MD5=[bd644e95feb6201a00b40e5eebab8e8c]
link call to good--><path d="M420.21,755.5692 C415.77,780.4392 413.51,818.6192 434.09,842.1992 C457.58,869.0992 548.58,883.2992 615.65,890.2692 " fill="none" id="call-to-good" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="620.84,890.7992,612.2994,885.8944,615.8665,890.2847,611.4762,893.8519,620.84,890.7992" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="489.59" y="800.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="78" x="463.59" y="811.1694">Receive referee</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="99" x="453.09" y="822.1694">signature Act:signed</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="135" x="435.09" y="833.1694">/Commit lift chits; Consense</text><!--MD5=[a9de27105e89a4d27fda4dc5e45750b6]
link call to void--><path d="M360.94,745.9692 C308.56,758.4092 242.24,775.6492 233.09,785.1992 C212.25,806.9492 207,842.0592 206.17,866.9692 " fill="none" id="call-to-void" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="206.06,872.1192,210.2646,863.213,206.1743,867.1205,202.2667,863.0302,206.06,872.1192" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="300.59" y="794.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="135" x="246.09" y="805.6694">Receive referee Act:timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="42" x="292.59" y="816.6694">/Too late</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="55" x="286.09" y="827.6694">abandon lift</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="159" x="234.09" y="838.6694">May try again with longer timeout</text><!--MD5=[f0fd2271ca83be14b7113b9e02bdd7cb]
link none to none--><path d="M1208.9,126.3292 C1226.43,123.4492 1243.59,126.7392 1243.59,136.1992 C1243.59,144.6992 1229.74,148.2192 1214.21,146.7492 " fill="none" id="none-to-none" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1208.9,146.0692,1217.3108,151.1935,1213.8585,146.7122,1218.3397,143.2599,1208.9,146.0692" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="1290.59" y="122.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="90" x="1258.59" y="133.6694">Receive Act:query</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="108" x="1249.59" y="144.6694">[Destination not found]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="81" x="1263.09" y="155.6694">/Reply Act: failed</text><!--MD5=[040d5384375abe6efad2c82f9b7cae97]
link none to relay--><path d="M1183.09,161.5892 C1183.09,188.6192 1183.09,233.5292 1183.09,272.1992 C1183.09,272.1992 1183.09,272.1992 1183.09,575.1992 C1183.09,624.6892 1218.17,672.4092 1244.53,701.2792 " fill="none" id="none-to-relay" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1248.02,705.0492,1244.8592,695.7213,1244.6304,701.3736,1238.9782,701.1447,1248.02,705.0492" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="1267.09" y="404.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="90" x="1235.09" y="415.6694">Receive Act:query</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="136" x="1212.09" y="426.6694">[Route found for destination]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="192" x="1184.09" y="437.6694">/Store lift Req:relay; Forward Act: query</text><!--MD5=[932e2266dc25e87ddfbfaeec5d8ff01e]
link relay to pend--><path d="M1259.43,755.2992 C1244.42,779.9392 1218.26,817.9492 1187.09,842.1992 C1172.61,853.4692 1155.41,862.8892 1138.51,870.5392 " fill="none" id="relay-to-pend" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="1133.75,872.6492,1143.5989,872.6549,1138.3202,870.6212,1140.354,865.3426,1133.75,872.6492" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="1266.09" y="805.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="59" x="1264.59" y="816.6694">Detect relay</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="110" x="1239.09" y="827.6694">/Forward lift Act: query</text><!--MD5=[c53c1e11ec8329e6f374aafba7fffcfc]
link none to local--><path d="M1208.89,138.4692 C1275.32,143.2492 1447.09,165.8992 1447.09,272.1992 C1447.09,272.1992 1447.09,272.1992 1447.09,575.1992 C1447.09,618.6692 1447.09,669.0392 1447.09,700.0192 " fill="none" id="none-to-local" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1447.09,705.1892,1451.09,696.1892,1447.09,700.1892,1443.09,696.1892,1447.09,705.1892" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="1496.59" y="404.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="90" x="1464.59" y="415.6694">Receive Act:query</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="123" x="1448.09" y="426.6694">[Destination found locally]</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="92" x="1463.59" y="437.6694">/Store lift Req: dest</text><!--MD5=[d3d9933f31736ef82111a9b8ed0b01e1]
link local to pend--><path d="M1434.62,755.3892 C1419.95,781.2392 1393.09,821.3192 1358.09,842.1992 C1321.96,863.7592 1213.87,879.6192 1139.08,888.3792 " fill="none" id="local-to-pend" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="1133.76,888.9992,1143.1589,891.9423,1138.7271,888.4266,1142.2427,883.9949,1133.76,888.9992" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="1465.59" y="805.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="59" x="1464.09" y="816.6694">Detect relay</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="157" x="1415.09" y="827.6694">/Reply to proposer Act: terminus</text><!--MD5=[7bb3568b6385ea64f5bc0ad26dc870fd]
link signable to good--><path d="M785.0286,858.4307 C784.1272,858.6932 783.2243,858.9603 782.3203,859.2317 C778.7044,860.3173 775.0713,861.4717 771.4475,862.6767 C764.2,865.0867 756.99,867.6992 750.03,870.3692 " fill="none" id="signable-to-good" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="745.36,872.1792,755.1976,872.6496,750.0208,870.3691,752.3014,865.1923,745.36,872.1792" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="935.09" y="805.6694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="88" x="904.09" y="816.6694">Receive signature</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="71" x="912.59" y="827.6694">via consensus</text><!--MD5=[7bb3568b6385ea64f5bc0ad26dc870fd]
link signable to good--><path d="M784.523,760.0573 C784.1356,760.2678 783.7485,760.4796 783.3619,760.6927 C770.9894,767.5105 759.035,775.6367 749.09,785.1992 C742.57,791.4792 719.97,836.5892 704.99,867.3292 " fill="none" id="signable-to-good-1" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="702.65,872.1392,710.1802,865.7913,704.8345,867.6417,702.9841,862.296,702.65,872.1392" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="804.59" y="800.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="113" x="761.09" y="811.1694">Receive signature from</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="100" x="767.59" y="822.1694">Proposer or Referee</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="135" x="750.09" y="833.1694">/Commit lift chits; Consense</text><!--MD5=[2d47bfcdfc5379471d9a4c3db6a2769d]
link pend to checkProp--><path d="M1008.97,922.2792 C993.57,930.5292 977.39,940.6292 964.09,952.1992 C944.29,969.4292 926.85,993.5692 914.88,1012.3692 " fill="none" id="pend-to-checkProp" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="911.95,1017.0192,920.1253,1011.527,914.6103,1012.7857,913.3516,1007.2706,911.95,1017.0192" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="978.09" y="961.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="974.09" y="972.6694">Local timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="82" x="965.09" y="983.6694">/Query Proposer</text><!--MD5=[9e9a88dde37fddb77f65c0f1f0bc7abb]
link checkProp to checkRef--><path d="M917.63,1067.3892 C932.1,1085.2992 952.3,1110.2892 970.09,1132.1992 C976.91,1140.5892 984.32,1149.6992 991.09,1158.0092 " fill="none" id="checkProp-to-checkRef" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="994.36,1162.0192,991.772,1152.5165,991.2,1158.1443,985.5722,1157.5724,994.36,1162.0192" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="981.09" y="1106.6694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="977.09" y="1117.6694">Local timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="76" x="971.09" y="1128.6694">/Query Referee</text><!--MD5=[eec98612677d31e77a97100daee276a6]
link checkRef to pend--><path d="M1035.49,1162.0292 C1042.03,1153.2292 1048.45,1142.8292 1052.09,1132.1992 C1076.21,1061.8092 1071.47,972.5192 1066.81,927.2892 " fill="none" id="checkRef-to-pend" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="1066.27,922.2592,1063.244,931.6317,1066.7986,927.2312,1071.1991,930.7859,1066.27,922.2592" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#FF0000" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="56" x="1091.09" y="1034.1694">DB Trigger:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="64" x="1087.09" y="1045.1694">Local timeout</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="96" x="1071.09" y="1056.1694">/Keep trying forever</text><!--MD5=[9abc0c8fb63ef3ddcc818ab4a621ca0a]
link signable to void--><path d="M783.9299,740.6496 C783.093,740.7664 782.2528,740.8842 781.4094,741.003 C778.0355,741.4785 774.6098,741.9706 771.143,742.4792 C764.2095,743.4964 757.1117,744.5797 749.9363,745.728 C692.5325,754.9142 630.155,768.2592 607.09,785.1992 C583.68,802.3992 599.03,825.7392 575.09,842.1992 C528.49,874.2492 373.33,887.7192 280.02,893.0392 " fill="none" id="signable-to-void" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="274.8,893.3292,284.0135,896.8093,279.7919,893.044,283.5571,888.8223,274.8,893.3292" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="645.09" y="800.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="100" x="608.09" y="811.1694">Receive cancel from</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="100" x="608.09" y="822.1694">Proposer or Referee</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="98" x="609.09" y="833.1694">/Void lift record/chits</text><!--MD5=[29b57aee40c7aafaf6bac2aab855b516]
link signable to pend--><path d="M863.16,731.2092 C865.84,731.5392 952.23,742.5892 1001.09,785.1992 C1026.36,807.2292 1043.47,842.1892 1053.2,866.9792 " fill="none" id="signable-to-pend" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1055.05,871.7992,1055.5465,861.9629,1053.2522,867.1336,1048.0815,864.8393,1055.05,871.7992" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#0000FF" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="26" x="1079.09" y="800.1694">Peer:</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="96" x="1044.09" y="811.1694">Receive intime from</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="100" x="1042.09" y="822.1694">Proposer or Referee</text><text fill="#333333" font-family="Helvetica" font-size="11" lengthAdjust="spacing" textLength="98" x="1043.09" y="833.1694">/Void lift record/chits</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="145" x="711.045" y="1256.8672">Thu Jul 01 13:41:29 MDT 2021</text><!--MD5=[e2ba6c8d4e73887e6fde8f758ef35296]
@startuml
!include common.puml

$title(Lift States)
[*] - -> none
state "No Lift" as none

'States are determined by a combination of values, as defined here:
draft: Stat: void, Req: draft
'init:  Stat: void, Req: init		'First implementation uses this.  Will try to avoid extra state in next version
seek:  Stat: seek, Req: N/A
term:  Stat: term, Req: N/A
call:  Stat: call, Req: N/A
good:  Stat: good, Req: N/A

state signable {
  pend:  Stat: pend, Req: N/A
  checkProp:  Stat: pend, Req: N/A, Time
  checkRef:  Stat: pend, Req: N/A, Time
}
void:  Stat: void, Req: N/A
local:  Stat: void, Req: local
relay:  Stat: void, Req: relay
timeCheck:  Stat: seek, Req: N/A, Time

'State transition rules:
none -[$user]-> draft: $trans($user,User initiates lift Req:draft,'')
'draft -[$db]-> init: $trans($db,draft detected,'',Forward Upstream Act:query)
draft -[$db]-> seek: $trans($db,draft detected,'',Send Upstream Act:query)

seek -[$peer]-> void: $trans($peer,Receive Act:fail,'','Lift failed; Notify referee, user')
seek -[$db]-> timeCheck: $trans($db,Local timeout,'', Lift expired?; Request status from referee)
timeCheck -[$peer]-> void: $trans($peer,Receive referee Act:timeout,'', 'Mark lift as expired')
timeCheck -[$peer]-> seek: $trans($peer,Receive referee Act:intime,'', 'Lift not yet expired')
seek -[$peer]-> term: $trans($peer,'Receive confirm from\ndestination Act:terminus','', 'Circuit good, freshen route')
term -[$db]-> call: $trans($db,Detect loopback,Lift still desirable, Request commit from referee)
term -[$db]-> call: $trans($db,Detect loopback,Change of mind, Notify referee of abort)
call -[$peer]-> good: $trans($peer,'Receive referee\nsignature Act:signed','', Commit lift chits; Consense)
call -[$peer]-> void: $trans($peer,Receive referee Act:timeout,'', 'Too late\nabandon lift\nMay try again with longer timeout')

none -[$peer]-> none: $trans($peer,Receive Act:query,Destination not found, Reply Act: failed)
none -[$peer]-> relay: $trans($peer,Receive Act:query,Route found for destination, 'Store lift Req:relay; Forward Act: query')
relay -[$db]-> pend: $trans($db,Detect relay,'', Forward lift Act: query)

none -[$peer]-> local: $trans($peer,Receive Act:query,Destination found locally, 'Store lift Req: dest')
local -[$db]-> pend: $trans($db,Detect relay,'', Reply to proposer Act: terminus)

signable -[$peer]-> good: $trans($peer,'Receive signature\nvia consensus')
pend -[$db]-> checkProp: $trans($db,Local timeout,'', Query Proposer)
checkProp -[$db]-> checkRef: $trans($db,Local timeout,'', Query Referee)
checkRef -[$db]-> pend: $trans($db,Local timeout,'', Keep trying forever)

signable -[$peer]-> good: $trans($peer,'Receive signature from\nProposer or Referee','', 'Commit lift chits; Consense')
signable -[$peer]-> void: $trans($peer,'Receive cancel from\nProposer or Referee','', 'Void lift record/chits')
signable -[$peer]-> pend: $trans($peer,'Receive intime from\nProposer or Referee','', 'Void lift record/chits')

@enduml

@startuml



skinparam backgroundColor fff
skinparam stereotypeCBackgroundColor 27d






skinparam circledCharacter {
  radius 8
  fontSize 11
  fontName Helvetica
}

skinparam class {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  attributeFontColor 333
  attributeFontSize 11
  attributeIconSize 11
}

skinparam actor {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam participant {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam collections {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam SequenceBox{
    backgroundColor e0e0e0
  borderColor cccccc
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam interface {
    backgroundColor 4af
  borderColor 27d
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}

skinparam component {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}



skinparam queue {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}


skinparam usecase {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam activity {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
}

skinparam sequence {
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11

  lifeLineBorderColor 4af
  lifeLineBackgroundColor e0e0e0
}




skinparam state {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
    arrowColor 000
  arrowFontName Helvetica
  arrowFontColor 333
  arrowFontSize 11
  startColor 4af
  endColor 27d
}

skinparam note {
    backgroundColor e8e8ea
  borderColor 202024
    fontColor 003
  fontName Helvetica
  fontSize 11
  stereotypeFontColor 333
  stereotypeFontSize 11
}








  title Lift States
  footer Thu Jul 01 13:41:29 MDT 2021
[*] - -> none
state "No Lift" as none

draft: Stat: void, Req: draft
seek:  Stat: seek, Req: N/A
term:  Stat: term, Req: N/A
call:  Stat: call, Req: N/A
good:  Stat: good, Req: N/A

state signable {
  pend:  Stat: pend, Req: N/A
  checkProp:  Stat: pend, Req: N/A, Time
  checkRef:  Stat: pend, Req: N/A, Time
}
void:  Stat: void, Req: N/A
local:  Stat: void, Req: local
relay:  Stat: void, Req: relay
timeCheck:  Stat: seek, Req: N/A, Time

none -[#green]-> draft: <font color=green>User:\nUser initiates lift Req:draft
draft -[#red]-> seek: <font color=red>DB Trigger:\ndraft detected\n/Send Upstream Act:query

seek -[#blue]-> void: <font color=blue>Peer:\nReceive Act:fail\n/Lift failed; Notify referee, user
seek -[#red]-> timeCheck: <font color=red>DB Trigger:\nLocal timeout\n/Lift expired?; Request status from referee
timeCheck -[#blue]-> void: <font color=blue>Peer:\nReceive referee Act:timeout\n/Mark lift as expired
timeCheck -[#blue]-> seek: <font color=blue>Peer:\nReceive referee Act:intime\n/Lift not yet expired
seek -[#blue]-> term: <font color=blue>Peer:\nReceive confirm from\ndestination Act:terminus\n/Circuit good, freshen route
term -[#red]-> call: <font color=red>DB Trigger:\nDetect loopback\n[Lift still desirable]\n/Request commit from referee
term -[#red]-> call: <font color=red>DB Trigger:\nDetect loopback\n[Change of mind]\n/Notify referee of abort
call -[#blue]-> good: <font color=blue>Peer:\nReceive referee\nsignature Act:signed\n/Commit lift chits; Consense
call -[#blue]-> void: <font color=blue>Peer:\nReceive referee Act:timeout\n/Too late\nabandon lift\nMay try again with longer timeout

none -[#blue]-> none: <font color=blue>Peer:\nReceive Act:query\n[Destination not found]\n/Reply Act: failed
none -[#blue]-> relay: <font color=blue>Peer:\nReceive Act:query\n[Route found for destination]\n/Store lift Req:relay; Forward Act: query
relay -[#red]-> pend: <font color=red>DB Trigger:\nDetect relay\n/Forward lift Act: query

none -[#blue]-> local: <font color=blue>Peer:\nReceive Act:query\n[Destination found locally]\n/Store lift Req: dest
local -[#red]-> pend: <font color=red>DB Trigger:\nDetect relay\n/Reply to proposer Act: terminus

signable -[#blue]-> good: <font color=blue>Peer:\nReceive signature\nvia consensus
pend -[#red]-> checkProp: <font color=red>DB Trigger:\nLocal timeout\n/Query Proposer
checkProp -[#red]-> checkRef: <font color=red>DB Trigger:\nLocal timeout\n/Query Referee
checkRef -[#red]-> pend: <font color=red>DB Trigger:\nLocal timeout\n/Keep trying forever

signable -[#blue]-> good: <font color=blue>Peer:\nReceive signature from\nProposer or Referee\n/Commit lift chits; Consense
signable -[#blue]-> void: <font color=blue>Peer:\nReceive cancel from\nProposer or Referee\n/Void lift record/chits
signable -[#blue]-> pend: <font color=blue>Peer:\nReceive intime from\nProposer or Referee\n/Void lift record/chits

@enduml

PlantUML version 1.2021.00(Sun Jan 10 03:25:05 MST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>