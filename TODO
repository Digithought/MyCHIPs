TODO:

Immediate:
- 
X- Change user primary key to p1000
X- Command line way to generate initial admin ticket, to file
X- Server fetches user key from db, authorizes websocket connection
X- If a token, validate based on its validity
X- Can connect to web socket via ticket from SPA
X- Connection uses username supplied by client to go with ticket
X- Show connection username in key list
X- Default database name to mychips, can be set different from server command line
X- Persistent key generated in browser, based on ticket info
X- Can export one or more keys
X- Connection public key shared with backend, stored in database with user
X- All connections to wyseman now have a database username associated with them
X- Can I still connect unsecurely for debugging?
X- User can connect from that browser without further authorization
X- Add the time into the signed message
- 
- Reasonable storage of state still works
- Can store my keys in the browser
- Can store my last connection in the browser
- Will try to connect automatically to the last site on reload
- 
- Make server process in wyselib that can stand alone without mychips
- Can/should mychips use wyselib server code as its core?
- 
- Move report launching structure into wyseman
- Move SPA clientip into wyseman/wyselib (clientinfo)
- 
- Connection/disconnection retrying working right
- Can begin to implement user permission structure
- Enable user permission editor in wysegi, and admin app user tab
- 
- Implement default load column in views, wylib uses it if present
- Implement default order column in views, wylib uses it if present
- Update audit tables to store changes as JSON
- 
- 
- Strdoc:
X- Submit in strdoc bubbles up through to main program
X- Can save content properly
X- In update routine, peel out title, text, (tag = source?)
X- Reload dbe after strdoc update?
X- Get report dialog to swallow strdoc menu (and/or make it sticky)?
X- Report popup has stringy or auto-hide menu
X- Implement dirty flag in strdoc
X- Get rid of valid flag in strdoc?
X- Connect publish to an action menu
X- How do actions work which have no preview window?
X- Use json-stable-stringify or fast-json-stable-stringify to generate hash
- What if I import a document into strdoc and then try to update?  (Do an insert?)
- Make source field I can enable with a button; Turns off other fields
- Preview mode includes language to refer to the included document (in current language?)
- Implement a few basic contracts using strdoc widget
- Harden contract views so you can only update working contracts (test)
- Implement publish procedure in backend (share code between reports)
- Begin wyseman library of server-side query builder functions (that reports can use)
- 
- How to serve my documents in HTML-viewable form if .html suffix given to web server
- Coded errors in wyseman.js get translated "badTuples" "badUpdate" etc
- 
- Wyselib:
- Move to concatenated primary key for entity P100, A100, C100
- Can still sort in numerical order
- Script to convert gnucash file to database format
- Concatenated key for project type, number
- Try porting my books into database format
- Can test project, account structures
- Scripts to auto-port all gnucash files into database
- 
- Implement password access over websocket to wyseman connection
- Do key exchange and store on server
- Insecure computer mode wipes localStorage
- 
- 
- 
- Lift modeling:
- System for instantiating multiple databases, multiple servers
- Central repository where agent users can choose from peers, not in their own DB
- DB support for peers, which are not local users
- Make paths_v properly detect paths to/from peers not on the same DB
- 
- Create remote query protocol
- Query adjoining DB's for pathway information
- Populate local DB with stubs for remote peers
- 
- Create remote lift protocol
- Design state machine to execute lifts
- 
- Build better agent model:
- Communicates with server through user port?
- Learns about other peers through central repository
- Some users are in same DB, others in a different one
- Work harder if my accrued receivables get low  
- Raise vendor accumulation limits if my receivables get high
- Create lift incentives if I get stale imbalances
- Extend credit to peers based only on their credit-worthiness
- 

General roadmap:
X- Can create/exchange tallies, chits with a peer
- Create agent client module to model user, reads/writes/listens direct with DB
- Can spawn N user agents against M server instances
X- Create graphical canvas view of all users balance sheets
- Implement lift algorithm
- Implement basic contracts (author, display, publish)
X- Review copyright; Should we limit free to people who respect a base contract?
- Harden SPA connections, implement user ID's, schema permissions
- Implement digital signatures for tallies, chits, contracts, lifts
- Implement encrypted network communications, noise protocol
- Harden database schema
X- Make Admin SPA GUI useable, replace all functions of mc_admin
- Make User SPA GUI useable
- Optimize User SPA GUI for mobile
- Rollout
- Implement async email/text notifications
- Implement native mobile user app
- Implement tally confirmations
- Implement standardized export/import of user accounts via Admin interface
- Implement lock-down mode
- Implement backup/restore among peers
- 

User agent process:
-   Be more random on search for new client tally connection
-   Find a foil tally and pay some credits on it
-   Agent establishes reasonable number of tallies with other users
-   If I already have a tally with you, don't do another one
- Try installing/running with SL and NA
-   Fill in tally limits data for all users
-   Each agent pays his downstreamers periodically
- Fill in buy/sell orders data for all users (Can I derive this from existing tally limits)
- Develop state machine for data queries
-   Can you find a path to user X?
-   Store data about known pathways
- Develop state machine for lift execution
-   Would you participate in a lift destined for user X, for Y CHIPs?
X- Dummy sql to create initial draft tally
- Dummy sql files to simulate other required user actions
- User agent process runs randomized strategy
- 

DB/schema:
- Change base.ent to make id, unique to ent_type
- Make consolidated key target field: P100, A100, G100
- Adjust all subordinate tables to point to the target field
- Create json views for tally import/export?
- Only allow minimum, required access/permissions
- Is each server a single user, or do real user ID's flow all the way to the database connection?
- Can run from schema sources, or from compiled schema 
- 

Peer-to-peer:
- Socket connections should time out and close after an idle period
X- Create state diagram for chits
X- Implement chit state map that runs under standard state interpretor
- Cache chit totals for each tally, on the fly
- State diagram for lifts
- Table for buy/sell preferences
- Make command handler for peer server
- Make ssl socket server for peer interface
- Handle user command to issue stock ticket
- User agent reads stock ticket, connects to peer
- Can user stock ticket to establish stock tally with issuing peer
- Can connect to multiple ID's over same peer server port
- Separate SSL certificate for each peer connection
- User initiated commands:
-   Initiate tally with (peer)
-   Send money to (peer)
-   Send invoice to (peer)
-   Set sell target of (issue)
-   Set buy target for (issue)
-   Get balance summary (date)
-   Get income/expense summary (start, end)
- 

Server:
- Show graphical view of all users connected via a set of specified SQL servers
- Server listens for authenticated peer connections
- Peers can connect and validate
- Server initiates trade requests
- 
- Admin SPA:
- Optimize SVG user graph reactivity.  Only update what has changed.
- Server listens on ticket port for specified timeout period
- User can connect/initialize using ticket
- Can export user to JSON
- Can export user to paper, w/ QR code
-  Admin can edit, create documents
-   

Wylib:
- Wylib login/validation for SPA client/server connections
- Make reports run more sensibly whether they have options or not
- Wylib report
-   Reports survive reloads
-   Auto size iframe to container window size
-   Can print from strdoc component
-   Can print out tally contract (with QR code paper backup)?
- Can export dbp view to a spreadsheet
- Report graphics (i.e. ticket) can export to graphic, attach to email, etc.
- How/when to self-heal components if state has extra, or not enough attributes
- Support for spreadsheet reports?
- Should we use a spreadsheet widget with file export?
- See TODO's/Fixme's in dbp and dbe
- wmd defaults for wyselib parameters
- wmd defaults for other wyselib/base files?
- Menu selector for accessing available actions in Dbp
- Implement save/restore on each tab (later?)
- 

- Wyseman:
- Can apply incremental delta scripts to go from one release to another
- 

- User SPA:
-   Can grab ticket
-   Can generate, configure keys
-   Save data in localStorage
-   User can generate tickets for other peers
-   Server listens for peer ticket connections
-   Can register buy/sell parameters
- 

Advanced Features:
- Implement writing a check:
-   User mobile clients can talk to each other in absense of internet or server connection
-   They exchange a check
-   The check is 'cashed' or recorded once the network comes back up
-   

Old TODOs:
- Request for a certificate be signed by others I trust?
- Cert must link public key to a chip ID, and to a distinct person
- 
- Launch processes to:
-   Initiate lift queries
-   Freshen our pathway cache
- 
- User asynchronous functions:
-   Approve/reject invoice
-   Approve/reject new tally
-   Alarm, warning
-   Alarm, lockdown
- 
- Peer commands:
-   Request link to parties that have your issue for sale
-   Request link to parties that have your issue for sale
-   Pass my request through to a referenced peer
-   Request info about a pathway to (peer)
